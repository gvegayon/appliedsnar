<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12.1 Example 1: Spillover effects in egocentric studies1 | Applied Network Science with R</title>
  <meta name="description" content="An improvised book on applied Network Science with R." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="12.1 Example 1: Spillover effects in egocentric studies1 | Applied Network Science with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An improvised book on applied Network Science with R." />
  <meta name="github-repo" content="gvegayon/appliedsnar" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12.1 Example 1: Spillover effects in egocentric studies1 | Applied Network Science with R" />
  
  <meta name="twitter:description" content="An improvised book on applied Network Science with R." />
  

<meta name="author" content="George G. Vega Yon, Ph.D." />


<meta name="date" content="2022-07-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="power-calculation-in-network-studies.html"/>
<link rel="next" href="example-2-spillover-effects-pre-post-effect.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-40608305-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-40608305-4');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Network Science with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Applications</b></span></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>3.1</b> What is R</a></li>
<li class="chapter" data-level="3.2" data-path="how-to-install-packages.html"><a href="how-to-install-packages.html"><i class="fa fa-check"></i><b>3.2</b> How to install packages</a></li>
<li class="chapter" data-level="3.3" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>3.3</b> Prerequisites</a></li>
<li class="chapter" data-level="3.4" data-path="a-gentle-quick-n-dirty-introduction-to-r.html"><a href="a-gentle-quick-n-dirty-introduction-to-r.html"><i class="fa fa-check"></i><b>3.4</b> A <del>gentle</del> Quick n’ Dirty Introduction to R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="network-nomination-data.html"><a href="network-nomination-data.html"><i class="fa fa-check"></i><b>4</b> Network Nomination Data</a><ul>
<li class="chapter" data-level="4.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html"><i class="fa fa-check"></i><b>4.1</b> Data preprocessing</a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html#reading-the-data-into-r"><i class="fa fa-check"></i><b>4.1.1</b> Reading the data into R</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-preprocessing.html"><a href="data-preprocessing.html#creating-a-unique-id-for-each-participant"><i class="fa fa-check"></i><b>4.1.2</b> Creating a unique id for each participant</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="creating-a-network.html"><a href="creating-a-network.html"><i class="fa fa-check"></i><b>4.2</b> Creating a network</a><ul>
<li class="chapter" data-level="4.2.1" data-path="creating-a-network.html"><a href="creating-a-network.html#from-survey-to-edgelist"><i class="fa fa-check"></i><b>4.2.1</b> From survey to edgelist</a></li>
<li class="chapter" data-level="4.2.2" data-path="creating-a-network.html"><a href="creating-a-network.html#igraph-network"><i class="fa fa-check"></i><b>4.2.2</b> igraph network</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="network-descriptive-stats.html"><a href="network-descriptive-stats.html"><i class="fa fa-check"></i><b>4.3</b> Network descriptive stats</a></li>
<li class="chapter" data-level="4.4" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html"><i class="fa fa-check"></i><b>4.4</b> Plotting the network in igraph</a><ul>
<li class="chapter" data-level="4.4.1" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#single-plot"><i class="fa fa-check"></i><b>4.4.1</b> Single plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#multiple-plots"><i class="fa fa-check"></i><b>4.4.2</b> Multiple plots</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>4.5</b> Statistical tests</a><ul>
<li class="chapter" data-level="4.5.1" data-path="statistical-tests.html"><a href="statistical-tests.html#is-nomination-number-correlated-with-indegree"><i class="fa fa-check"></i><b>4.5.1</b> Is nomination number correlated with indegree?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exponential-random-graph-models.html"><a href="exponential-random-graph-models.html"><i class="fa fa-check"></i><b>5</b> Exponential Random Graph Models</a><ul>
<li class="chapter" data-level="5.1" data-path="a-naïve-example.html"><a href="a-naïve-example.html"><i class="fa fa-check"></i><b>5.1</b> A naïve example</a></li>
<li class="chapter" data-level="5.2" data-path="estimation-of-ergms.html"><a href="estimation-of-ergms.html"><i class="fa fa-check"></i><b>5.2</b> Estimation of ERGMs</a></li>
<li class="chapter" data-level="5.3" data-path="the-ergm-package.html"><a href="the-ergm-package.html"><i class="fa fa-check"></i><b>5.3</b> The <code>ergm</code> package</a></li>
<li class="chapter" data-level="5.4" data-path="running-ergms.html"><a href="running-ergms.html"><i class="fa fa-check"></i><b>5.4</b> Running ERGMs</a></li>
<li class="chapter" data-level="5.5" data-path="model-goodness-of-fit.html"><a href="model-goodness-of-fit.html"><i class="fa fa-check"></i><b>5.5</b> Model Goodness-of-Fit</a></li>
<li class="chapter" data-level="5.6" data-path="more-on-mcmc-convergence.html"><a href="more-on-mcmc-convergence.html"><i class="fa fa-check"></i><b>5.6</b> More on MCMC convergence</a></li>
<li class="chapter" data-level="5.7" data-path="mathematical-interpretation.html"><a href="mathematical-interpretation.html"><i class="fa fa-check"></i><b>5.7</b> Mathematical Interpretation</a></li>
<li class="chapter" data-level="5.8" data-path="markov-independence.html"><a href="markov-independence.html"><i class="fa fa-check"></i><b>5.8</b> Markov independence</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-constraints-in-ergms.html"><a href="using-constraints-in-ergms.html"><i class="fa fa-check"></i><b>6</b> Using constraints in ERGMs</a><ul>
<li class="chapter" data-level="6.1" data-path="example-1-interlocking-egos-and-disconnected-alters.html"><a href="example-1-interlocking-egos-and-disconnected-alters.html"><i class="fa fa-check"></i><b>6.1</b> Example 1: Interlocking egos and disconnected alters</a></li>
<li class="chapter" data-level="6.2" data-path="example-2-bi-partite-networks.html"><a href="example-2-bi-partite-networks.html"><i class="fa fa-check"></i><b>6.2</b> Example 2: Bi-partite networks</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="separable-temporal-exponential-family-random-graph-models.html"><a href="separable-temporal-exponential-family-random-graph-models.html"><i class="fa fa-check"></i><b>7</b> (Separable) Temporal Exponential Family Random Graph Models</a></li>
<li class="chapter" data-level="8" data-path="simulating-and-visualizing-networks.html"><a href="simulating-and-visualizing-networks.html"><i class="fa fa-check"></i><b>8</b> Simulating and visualizing networks</a><ul>
<li class="chapter" data-level="8.1" data-path="random-graph-models.html"><a href="random-graph-models.html"><i class="fa fa-check"></i><b>8.1</b> Random Graph Models</a></li>
<li class="chapter" data-level="8.2" data-path="social-networks-in-schools.html"><a href="social-networks-in-schools.html"><i class="fa fa-check"></i><b>8.2</b> Social Networks in Schools</a></li>
<li class="chapter" data-level="8.3" data-path="reading-a-network.html"><a href="reading-a-network.html"><i class="fa fa-check"></i><b>8.3</b> Reading a network</a></li>
<li class="chapter" data-level="8.4" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html"><i class="fa fa-check"></i><b>8.4</b> Visualizing the network</a><ul>
<li class="chapter" data-level="8.4.1" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html#vertex-size"><i class="fa fa-check"></i><b>8.4.1</b> Vertex size</a></li>
<li class="chapter" data-level="8.4.2" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html#vertex-color"><i class="fa fa-check"></i><b>8.4.2</b> Vertex color</a></li>
<li class="chapter" data-level="8.4.3" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html#vertex-shape"><i class="fa fa-check"></i><b>8.4.3</b> Vertex shape</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hypothesis-testing-in-networks.html"><a href="hypothesis-testing-in-networks.html"><i class="fa fa-check"></i><b>9</b> Hypothesis testing in networks</a><ul>
<li class="chapter" data-level="9.1" data-path="comparing-networks.html"><a href="comparing-networks.html"><i class="fa fa-check"></i><b>9.1</b> Comparing networks</a><ul>
<li class="chapter" data-level="9.1.1" data-path="comparing-networks.html"><a href="comparing-networks.html#network-bootstrap"><i class="fa fa-check"></i><b>9.1.1</b> Network bootstrap</a></li>
<li class="chapter" data-level="9.1.2" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-normal"><i class="fa fa-check"></i><b>9.1.2</b> When the statistic is normal</a></li>
<li class="chapter" data-level="9.1.3" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-not-normal"><i class="fa fa-check"></i><b>9.1.3</b> When the statistic is NOT normal</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>9.2</b> Examples</a><ul>
<li class="chapter" data-level="9.2.1" data-path="examples.html"><a href="examples.html#average-of-node-level-stats"><i class="fa fa-check"></i><b>9.2.1</b> Average of node-level stats</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="network-diffussion-with-netdiffuser.html"><a href="network-diffussion-with-netdiffuser.html"><i class="fa fa-check"></i><b>10</b> Network diffussion with <code>netdiffuseR</code></a><ul>
<li class="chapter" data-level="10.1" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html"><i class="fa fa-check"></i><b>10.1</b> Network diffusion of innovation</a><ul>
<li class="chapter" data-level="10.1.1" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html#diffusion-networks"><i class="fa fa-check"></i><b>10.1.1</b> Diffusion networks</a></li>
<li class="chapter" data-level="10.1.2" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html#thresholds"><i class="fa fa-check"></i><b>10.1.2</b> Thresholds</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html"><i class="fa fa-check"></i><b>10.2</b> The netdiffuseR R package</a><ul>
<li class="chapter" data-level="10.2.1" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#overview"><i class="fa fa-check"></i><b>10.2.1</b> Overview</a></li>
<li class="chapter" data-level="10.2.2" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#datasets"><i class="fa fa-check"></i><b>10.2.2</b> Datasets</a></li>
<li class="chapter" data-level="10.2.3" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#visualization-methods"><i class="fa fa-check"></i><b>10.2.3</b> Visualization methods</a></li>
<li class="chapter" data-level="10.2.4" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#problems"><i class="fa fa-check"></i><b>10.2.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html"><i class="fa fa-check"></i><b>10.3</b> Simulation of diffusion processes</a><ul>
<li class="chapter" data-level="10.3.1" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#simulating-diffusion-networks"><i class="fa fa-check"></i><b>10.3.1</b> Simulating diffusion networks</a></li>
<li class="chapter" data-level="10.3.2" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#rumor-spreading"><i class="fa fa-check"></i><b>10.3.2</b> Rumor spreading</a></li>
<li class="chapter" data-level="10.3.3" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#difussion"><i class="fa fa-check"></i><b>10.3.3</b> Difussion</a></li>
<li class="chapter" data-level="10.3.4" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#mentor-matching"><i class="fa fa-check"></i><b>10.3.4</b> Mentor Matching</a></li>
<li class="chapter" data-level="10.3.5" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#example-by-changing-threshold"><i class="fa fa-check"></i><b>10.3.5</b> Example by changing threshold</a></li>
<li class="chapter" data-level="10.3.6" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#problems-1"><i class="fa fa-check"></i><b>10.3.6</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>10.4</b> Statistical inference</a><ul>
<li class="chapter" data-level="10.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#morans-i"><i class="fa fa-check"></i><b>10.4.1</b> Moran’s I</a></li>
<li class="chapter" data-level="10.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#using-geodesics"><i class="fa fa-check"></i><b>10.4.2</b> Using geodesics</a></li>
<li class="chapter" data-level="10.4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#structural-dependence-and-permutation-tests"><i class="fa fa-check"></i><b>10.4.3</b> Structural dependence and permutation tests</a></li>
<li class="chapter" data-level="10.4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#idea"><i class="fa fa-check"></i><b>10.4.4</b> Idea</a></li>
<li class="chapter" data-level="10.4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#regression-analysis"><i class="fa fa-check"></i><b>10.4.5</b> Regression analysis</a></li>
<li class="chapter" data-level="10.4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#problems-2"><i class="fa fa-check"></i><b>10.4.6</b> Problems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="stochastic-actor-oriented-models.html"><a href="stochastic-actor-oriented-models.html"><i class="fa fa-check"></i><b>11</b> Stochastic Actor Oriented Models</a></li>
<li class="chapter" data-level="12" data-path="power-calculation-in-network-studies.html"><a href="power-calculation-in-network-studies.html"><i class="fa fa-check"></i><b>12</b> Power calculation in network studies</a><ul>
<li class="chapter" data-level="12.1" data-path="example-1-spillover-effects-in-egocentric-studiescredit-ego-power.html"><a href="example-1-spillover-effects-in-egocentric-studiescredit-ego-power.html"><i class="fa fa-check"></i><b>12.1</b> Example 1: Spillover effects in egocentric studies</a></li>
<li class="chapter" data-level="12.2" data-path="example-2-spillover-effects-pre-post-effect.html"><a href="example-2-spillover-effects-pre-post-effect.html"><i class="fa fa-check"></i><b>12.2</b> Example 2: Spillover effects pre-post effect</a></li>
<li class="chapter" data-level="12.3" data-path="example-3-first-difference.html"><a href="example-3-first-difference.html"><i class="fa fa-check"></i><b>12.3</b> Example 3: First difference</a></li>
</ul></li>
<li class="part"><span><b>II Statistical Foundations</b></span></li>
<li class="chapter" data-level="13" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>13</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="13.1" data-path="metropolis-algorithm.html"><a href="metropolis-algorithm.html"><i class="fa fa-check"></i><b>13.1</b> Metropolis Algorithm</a></li>
<li class="chapter" data-level="13.2" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i><b>13.2</b> Metropolis-Hastings</a></li>
<li class="chapter" data-level="13.3" data-path="likelihood-free-mcmc.html"><a href="likelihood-free-mcmc.html"><i class="fa fa-check"></i><b>13.3</b> Likelihood-free MCMC</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="part2-power.html"><a href="part2-power.html"><i class="fa fa-check"></i><b>14</b> Power and sample size</a><ul>
<li class="chapter" data-level="14.1" data-path="error-types.html"><a href="error-types.html"><i class="fa fa-check"></i><b>14.1</b> Error types</a></li>
<li class="chapter" data-level="14.2" data-path="example-1-sample-size-for-a-proportion.html"><a href="example-1-sample-size-for-a-proportion.html"><i class="fa fa-check"></i><b>14.2</b> Example 1: Sample size for a proportion</a></li>
<li class="chapter" data-level="14.3" data-path="example-2-sample-size-for-a-proportion-vis.html"><a href="example-2-sample-size-for-a-proportion-vis.html"><i class="fa fa-check"></i><b>14.3</b> Example 2: Sample size for a proportion (vis)</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="datasets-1.html"><a href="datasets-1.html"><i class="fa fa-check"></i><b>A</b> Datasets</a><ul>
<li class="chapter" data-level="A.1" data-path="sns-data.html"><a href="sns-data.html"><i class="fa fa-check"></i><b>A.1</b> SNS data</a><ul>
<li class="chapter" data-level="A.1.1" data-path="sns-data.html"><a href="sns-data.html#about-the-data"><i class="fa fa-check"></i><b>A.1.1</b> About the data</a></li>
<li class="chapter" data-level="A.1.2" data-path="sns-data.html"><a href="sns-data.html#variables"><i class="fa fa-check"></i><b>A.1.2</b> Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Network Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-1-spillover-effects-in-egocentric-studiescredit-ego-power" class="section level2 hasAnchor">
<h2><span class="header-section-number">12.1</span> Example 1: Spillover effects in egocentric studies<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a><a href="example-1-spillover-effects-in-egocentric-studiescredit-ego-power.html#example-1-spillover-effects-in-egocentric-studiescredit-ego-power" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we want to run an intervention over a particular population, and we are interested in the effects of such intervention on the egos’ alters. In economics, this problem, which they call the “spillover effect,” is actively studied.</p>
<p>We assume that alters only get exposed if egos acquire the behavior for the power calculation. Furthermore, for this first run, we will assume that there is no social reinforcement or influence between alters. We will later relax this assumption. To calculate power, we will do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Simulate egos’ behavior following a logit distribution.</p></li>
<li><p>Randomly drop some egos as a result of attrition.</p></li>
<li><p>Simulate alters’ behavior using their egos as the treatment.</p></li>
<li><p>Fit a logistic regression based on the previous model.</p></li>
<li><p>Accept/reject the null and store the result.</p></li>
</ol>
<p>The previous steps will be repeated 500 for each value of <span class="math inline">\(n\)</span> we analyze. We will finalize by plotting power against sample sizes. Let’s first start by writing down the simulation parameters:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Design</span></a>
<a class="sourceLine" id="cb1-2" title="2">n_sims    &lt;-<span class="st"> </span><span class="dv">500</span> <span class="co"># Number of simulations</span></a>
<a class="sourceLine" id="cb1-3" title="3">n_a       &lt;-<span class="st"> </span><span class="dv">4</span>   <span class="co"># Number of alters</span></a>
<a class="sourceLine" id="cb1-4" title="4">sizes     &lt;-<span class="st">     </span><span class="co"># Sizes to try</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="st">  </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">100</span>, <span class="dt">to =</span> <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co"># Assumptions</span></a>
<a class="sourceLine" id="cb1-8" title="8">odds_h_<span class="dv">1</span>  &lt;-<span class="st"> </span><span class="fl">2.0</span> <span class="co"># Odds of Increase/</span></a>
<a class="sourceLine" id="cb1-9" title="9">attrition &lt;-<span class="st"> </span><span class="fl">.3</span></a>
<a class="sourceLine" id="cb1-10" title="10">baseline  &lt;-<span class="st"> </span><span class="fl">.2</span>  <span class="co"># Low prevalence in 1s</span></a>
<a class="sourceLine" id="cb1-11" title="11"></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co"># Parameters</span></a>
<a class="sourceLine" id="cb1-13" title="13">alpha    &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb1-14" title="14">beta_pow &lt;-<span class="st"> </span><span class="fl">0.2</span></a></code></pre></div>
<p>As we discuss in <a href="part2-power.html#part2-power">14</a>, it is always a good idea to encapsulate the simulation into a function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># The odds turned to a prob</span></a>
<a class="sourceLine" id="cb2-2" title="2">theta_h_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">plogis</span>(<span class="kw">log</span>(odds_h_<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># Simulation function</span></a>
<a class="sourceLine" id="cb2-5" title="5">sim_data &lt;-<span class="st"> </span><span class="cf">function</span>(n) {</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="co"># Treatment assignment</span></a>
<a class="sourceLine" id="cb2-8" title="8">  tr  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, n<span class="op">/</span><span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">0</span>, n<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="co"># Step 1: Sampling population of egos</span></a>
<a class="sourceLine" id="cb2-11" title="11">  y_ego &lt;-<span class="st"> </span><span class="kw">runif</span>(n) <span class="op">&lt;</span><span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="kw">rep</span>(theta_h_<span class="dv">1</span>, n<span class="op">/</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb2-13" title="13">    <span class="kw">rep</span>(<span class="fl">0.5</span>, n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-14" title="14">  )</a>
<a class="sourceLine" id="cb2-15" title="15"></a>
<a class="sourceLine" id="cb2-16" title="16">  <span class="co"># Step 2: Simulating attrition</span></a>
<a class="sourceLine" id="cb2-17" title="17">  todrop &lt;-<span class="st"> </span><span class="kw">order</span>(<span class="kw">runif</span>(n))[<span class="dv">1</span><span class="op">:</span>(n <span class="op">*</span><span class="st"> </span>attrition)]</a>
<a class="sourceLine" id="cb2-18" title="18">  y_ego  &lt;-<span class="st"> </span>y_ego[<span class="op">-</span>todrop]</a>
<a class="sourceLine" id="cb2-19" title="19">  tr     &lt;-<span class="st"> </span>tr[<span class="op">-</span>todrop]</a>
<a class="sourceLine" id="cb2-20" title="20">  n      &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(todrop)</a>
<a class="sourceLine" id="cb2-21" title="21"></a>
<a class="sourceLine" id="cb2-22" title="22">  <span class="co"># Step 3: Simulating alter&#39;s effect. We assume the same as in</span></a>
<a class="sourceLine" id="cb2-23" title="23">  <span class="co"># ego</span></a>
<a class="sourceLine" id="cb2-24" title="24">  tr_alter &lt;-<span class="st"> </span><span class="kw">rep</span>(y_ego <span class="op">*</span><span class="st"> </span>tr, n_a)</a>
<a class="sourceLine" id="cb2-25" title="25">  y_alter  &lt;-<span class="st"> </span><span class="kw">runif</span>(n <span class="op">*</span><span class="st"> </span>n_a) <span class="op">&lt;</span><span class="st"> </span><span class="kw">ifelse</span>(tr_alter, theta_h_<span class="dv">1</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb2-26" title="26"></a>
<a class="sourceLine" id="cb2-27" title="27">  <span class="co"># Step 4: Computing test statistic</span></a>
<a class="sourceLine" id="cb2-28" title="28">  res_ego   &lt;-<span class="st"> </span><span class="kw">tryCatch</span>(<span class="kw">glm</span>(y_ego <span class="op">~</span><span class="st"> </span>tr, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>)), <span class="dt">error =</span> <span class="cf">function</span>(e) e)</a>
<a class="sourceLine" id="cb2-29" title="29">  res_alter &lt;-<span class="st"> </span><span class="kw">tryCatch</span>(<span class="kw">glm</span>(y_alter <span class="op">~</span><span class="st"> </span>tr_alter, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>)), <span class="dt">error =</span> <span class="cf">function</span>(e) e)</a>
<a class="sourceLine" id="cb2-30" title="30"></a>
<a class="sourceLine" id="cb2-31" title="31">  <span class="cf">if</span> (<span class="kw">inherits</span>(res_ego, <span class="st">&quot;error&quot;</span>) <span class="op">|</span><span class="st"> </span><span class="kw">inherits</span>(res_alter, <span class="st">&quot;error&quot;</span>))</a>
<a class="sourceLine" id="cb2-32" title="32">    <span class="kw">return</span>(<span class="kw">c</span>(<span class="dt">ego =</span>  <span class="ot">NA</span>, <span class="dt">alter =</span> <span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb2-33" title="33">  </a>
<a class="sourceLine" id="cb2-34" title="34">  <span class="co"># Step 5: Reject?</span></a>
<a class="sourceLine" id="cb2-35" title="35">  <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb2-36" title="36">    <span class="dt">ego   =</span> <span class="kw">summary</span>(res_ego)<span class="op">$</span>coefficients[<span class="st">&quot;tr&quot;</span>, <span class="st">&quot;Pr(&gt;|z|)&quot;</span>] <span class="op">&lt;</span><span class="st"> </span>alpha,</a>
<a class="sourceLine" id="cb2-37" title="37">    <span class="dt">alter =</span> <span class="kw">summary</span>(res_alter)<span class="op">$</span>coefficients[<span class="st">&quot;tr_alter&quot;</span>, <span class="st">&quot;Pr(&gt;|z|)&quot;</span>] <span class="op">&lt;</span><span class="st"> </span>alpha</a>
<a class="sourceLine" id="cb2-38" title="38">  )</a>
<a class="sourceLine" id="cb2-39" title="39">  </a>
<a class="sourceLine" id="cb2-40" title="40"></a>
<a class="sourceLine" id="cb2-41" title="41">}</a></code></pre></div>
<p>Now that we have the data generating function, we can run the simulations to approximate statistical power given the sample size. The results will be stored in the matrix <code>spower</code>. Since we are simulating data, it is crucial to set the seed so we can reproduce the results.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># We always set the seed</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">set.seed</span>(<span class="dv">88</span>) </a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># Making space, and running!</span></a>
<a class="sourceLine" id="cb3-5" title="5">spower &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="cf">for</span> (s <span class="cf">in</span> sizes) {</a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8">  <span class="co"># Run the simulation for size s</span></a>
<a class="sourceLine" id="cb3-9" title="9">  simres &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(<span class="kw">replicate</span>(n_sims, <span class="kw">sim_data</span>(s)), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-10" title="10"></a>
<a class="sourceLine" id="cb3-11" title="11">  <span class="co"># And store the results</span></a>
<a class="sourceLine" id="cb3-12" title="12">  spower &lt;-<span class="st"> </span><span class="kw">rbind</span>(spower, simres)</a>
<a class="sourceLine" id="cb3-13" title="13"></a>
<a class="sourceLine" id="cb3-14" title="14">}</a></code></pre></div>
<p>The following figure shows the approximate power for finding effects at both levels, ego and alter:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3">spower &lt;-<span class="st"> </span><span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="kw">data.frame</span>(<span class="dt">size =</span> sizes, <span class="dt">power =</span> spower[,<span class="st">&quot;ego&quot;</span>], <span class="dt">type =</span>  <span class="st">&quot;ego&quot;</span>),</a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="kw">data.frame</span>(<span class="dt">size =</span> sizes, <span class="dt">power =</span> spower[,<span class="st">&quot;alter&quot;</span>], <span class="dt">type =</span>  <span class="st">&quot;alter&quot;</span>)</a>
<a class="sourceLine" id="cb4-6" title="6">)</a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8">spower <span class="op">|</span><span class="er">&gt;</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> size, <span class="dt">y =</span> power, <span class="dt">colour =</span> type)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Number of Egos&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Approx. Power&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Node type&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>beta_pow)</a></code></pre></div>
<p><img src="part-01-10-power_files/figure-html/part-01-power-plot1-1.png" width="672" /></p>
<p>As shown in Chapter <a href="part2-power.html#part2-power">14</a>, we can use a linear regression model to predict sample size as a function of statistical power:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># Fitting the model</span></a>
<a class="sourceLine" id="cb5-2" title="2">power_model &lt;-<span class="st"> </span><span class="kw">glm</span>(</a>
<a class="sourceLine" id="cb5-3" title="3">  size <span class="op">~</span><span class="st"> </span>power <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(power<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="dt">data =</span> spower, <span class="dt">family =</span> <span class="kw">gaussian</span>(), <span class="dt">subset =</span> type <span class="op">==</span><span class="st"> &quot;alter&quot;</span></a>
<a class="sourceLine" id="cb5-5" title="5">)</a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="kw">summary</span>(power_model)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = size ~ power + I(power^2), family = gaussian(), 
##     data = spower, subset = type == &quot;alter&quot;)
## 
## Deviance Residuals: 
##        6         7         8         9        10  
##   0.2658  -11.2195   10.5568  -13.8852   14.2821  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)     1460       1342   1.088    0.390
## power          -3532       3124  -1.131    0.376
## I(power^2)      2293       1805   1.270    0.332
## 
## (Dispersion parameter for gaussian family taken to be 317.0856)
## 
##     Null deviance: 6250.00  on 4  degrees of freedom
## Residual deviance:  634.17  on 2  degrees of freedom
## AIC: 46.404
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Predict</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">predict</span>(power_model, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">power =</span> <span class="fl">.8</span>), <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>) <span class="op">|</span><span class="er">&gt;</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw">ceiling</span>()</a></code></pre></div>
<pre><code>##   1 
## 102</code></pre>
<p>From the figure, it becomes apparent that, although there is not enough power to identify effects at the ego level, because each ego brings in five alters, the alter sample size is high enough that we can reach above 0.8 statistical power with relatively small sample size.</p>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>The original problem was posed by <a href="https://faculty.utah.edu/u6037777-SHINDUK_LEE/hm/index.hml">Dr. Shinduk Lee</a> from the School of Nursing at the University of Utah.<a href="example-1-spillover-effects-in-egocentric-studiescredit-ego-power.html#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="power-calculation-in-network-studies.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="example-2-spillover-effects-pre-post-effect.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/gvegayon/appliedsnar/edit/master/part-01-10-power.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/gvegayon/appliedsnar/blob/master/part-01-10-power.Rmd",
"text": null
},
"download": ["appliedsnar.pdf", "appliedsnar.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
