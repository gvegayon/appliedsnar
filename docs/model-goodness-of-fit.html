<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.5 Model Goodness-of-Fit | Applied Network Science with R</title>
  <meta name="description" content="An improvised book on applied Network Science with R." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="6.5 Model Goodness-of-Fit | Applied Network Science with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An improvised book on applied Network Science with R." />
  <meta name="github-repo" content="gvegayon/appliedsnar" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.5 Model Goodness-of-Fit | Applied Network Science with R" />
  
  <meta name="twitter:description" content="An improvised book on applied Network Science with R." />
  

<meta name="author" content="George G. Vega Yon, Ph.D." />


<meta name="date" content="2024-01-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="running-ergms.html"/>
<link rel="next" href="more-on-mcmc-convergence.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-40608305-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-40608305-4');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Network Science with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i><b>2</b> About the Author</a></li>
<li class="part"><span><b>I Applications</b></span></li>
<li class="chapter" data-level="3" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>3</b> Introduction</a></li>
<li class="chapter" data-level="4" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>4</b> R Basics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>4.1</b> What is R</a></li>
<li class="chapter" data-level="4.2" data-path="how-to-install-packages.html"><a href="how-to-install-packages.html"><i class="fa fa-check"></i><b>4.2</b> How to install packages</a></li>
<li class="chapter" data-level="4.3" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>4.3</b> Prerequisites</a></li>
<li class="chapter" data-level="4.4" data-path="a-gentle-quick-n-dirty-introduction-to-r.html"><a href="a-gentle-quick-n-dirty-introduction-to-r.html"><i class="fa fa-check"></i><b>4.4</b> A <del>gentle</del> Quick n’ Dirty Introduction to R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="network-nomination-data.html"><a href="network-nomination-data.html"><i class="fa fa-check"></i><b>5</b> Network Nomination Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html"><i class="fa fa-check"></i><b>5.1</b> Data preprocessing</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html#reading-the-data-into-r"><i class="fa fa-check"></i><b>5.1.1</b> Reading the data into R</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-preprocessing.html"><a href="data-preprocessing.html#creating-a-unique-id-for-each-participant"><i class="fa fa-check"></i><b>5.1.2</b> Creating a unique id for each participant</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="creating-a-network.html"><a href="creating-a-network.html"><i class="fa fa-check"></i><b>5.2</b> Creating a network</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="creating-a-network.html"><a href="creating-a-network.html#from-survey-to-edgelist"><i class="fa fa-check"></i><b>5.2.1</b> From survey to edgelist</a></li>
<li class="chapter" data-level="5.2.2" data-path="creating-a-network.html"><a href="creating-a-network.html#igraph-network"><i class="fa fa-check"></i><b>5.2.2</b> igraph network</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="network-descriptive-stats.html"><a href="network-descriptive-stats.html"><i class="fa fa-check"></i><b>5.3</b> Network descriptive stats</a></li>
<li class="chapter" data-level="5.4" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html"><i class="fa fa-check"></i><b>5.4</b> Plotting the network in igraph</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#single-plot"><i class="fa fa-check"></i><b>5.4.1</b> Single plot</a></li>
<li class="chapter" data-level="5.4.2" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#multiple-plots"><i class="fa fa-check"></i><b>5.4.2</b> Multiple plots</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>5.5</b> Statistical tests</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="statistical-tests.html"><a href="statistical-tests.html#is-nomination-number-correlated-with-indegree"><i class="fa fa-check"></i><b>5.5.1</b> Is nomination number correlated with indegree?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exponential-random-graph-models.html"><a href="exponential-random-graph-models.html"><i class="fa fa-check"></i><b>6</b> Exponential Random Graph Models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="a-naïve-example.html"><a href="a-naïve-example.html"><i class="fa fa-check"></i><b>6.1</b> A naïve example</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-of-ergms.html"><a href="estimation-of-ergms.html"><i class="fa fa-check"></i><b>6.2</b> Estimation of ERGMs</a></li>
<li class="chapter" data-level="6.3" data-path="the-ergm-package.html"><a href="the-ergm-package.html"><i class="fa fa-check"></i><b>6.3</b> The <code>ergm</code> package</a></li>
<li class="chapter" data-level="6.4" data-path="running-ergms.html"><a href="running-ergms.html"><i class="fa fa-check"></i><b>6.4</b> Running ERGMs</a></li>
<li class="chapter" data-level="6.5" data-path="model-goodness-of-fit.html"><a href="model-goodness-of-fit.html"><i class="fa fa-check"></i><b>6.5</b> Model Goodness-of-Fit</a></li>
<li class="chapter" data-level="6.6" data-path="more-on-mcmc-convergence.html"><a href="more-on-mcmc-convergence.html"><i class="fa fa-check"></i><b>6.6</b> More on MCMC convergence</a></li>
<li class="chapter" data-level="6.7" data-path="mathematical-interpretation.html"><a href="mathematical-interpretation.html"><i class="fa fa-check"></i><b>6.7</b> Mathematical Interpretation</a></li>
<li class="chapter" data-level="6.8" data-path="markov-independence.html"><a href="markov-independence.html"><i class="fa fa-check"></i><b>6.8</b> Markov independence</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="using-constraints-in-ergms.html"><a href="using-constraints-in-ergms.html"><i class="fa fa-check"></i><b>7</b> Using constraints in ERGMs</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example-1-interlocking-egos-and-disconnected-alters.html"><a href="example-1-interlocking-egos-and-disconnected-alters.html"><i class="fa fa-check"></i><b>7.1</b> Example 1: Interlocking egos and disconnected alters</a></li>
<li class="chapter" data-level="7.2" data-path="example-2-bi-partite-networks.html"><a href="example-2-bi-partite-networks.html"><i class="fa fa-check"></i><b>7.2</b> Example 2: Bi-partite networks</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="separable-temporal-exponential-family-random-graph-models.html"><a href="separable-temporal-exponential-family-random-graph-models.html"><i class="fa fa-check"></i><b>8</b> (Separable) Temporal Exponential Family Random Graph Models</a></li>
<li class="chapter" data-level="9" data-path="simulating-and-visualizing-networks.html"><a href="simulating-and-visualizing-networks.html"><i class="fa fa-check"></i><b>9</b> Simulating and visualizing networks</a>
<ul>
<li class="chapter" data-level="9.1" data-path="random-graph-models.html"><a href="random-graph-models.html"><i class="fa fa-check"></i><b>9.1</b> Random Graph Models</a></li>
<li class="chapter" data-level="9.2" data-path="social-networks-in-schools.html"><a href="social-networks-in-schools.html"><i class="fa fa-check"></i><b>9.2</b> Social Networks in Schools</a></li>
<li class="chapter" data-level="9.3" data-path="reading-a-network.html"><a href="reading-a-network.html"><i class="fa fa-check"></i><b>9.3</b> Reading a network</a></li>
<li class="chapter" data-level="9.4" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html"><i class="fa fa-check"></i><b>9.4</b> Visualizing the network</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html#vertex-size"><i class="fa fa-check"></i><b>9.4.1</b> Vertex size</a></li>
<li class="chapter" data-level="9.4.2" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html#vertex-color"><i class="fa fa-check"></i><b>9.4.2</b> Vertex color</a></li>
<li class="chapter" data-level="9.4.3" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html#vertex-shape"><i class="fa fa-check"></i><b>9.4.3</b> Vertex shape</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="egocentric-networks.html"><a href="egocentric-networks.html"><i class="fa fa-check"></i><b>10</b> Egocentric networks</a>
<ul>
<li class="chapter" data-level="10.1" data-path="network-files-graphml.html"><a href="network-files-graphml.html"><i class="fa fa-check"></i><b>10.1</b> Network files (graphml)</a></li>
<li class="chapter" data-level="10.2" data-path="person-files.html"><a href="person-files.html"><i class="fa fa-check"></i><b>10.2</b> Person files</a></li>
<li class="chapter" data-level="10.3" data-path="ego-files.html"><a href="ego-files.html"><i class="fa fa-check"></i><b>10.3</b> Ego files</a></li>
<li class="chapter" data-level="10.4" data-path="edgelist-files.html"><a href="edgelist-files.html"><i class="fa fa-check"></i><b>10.4</b> Edgelist files</a></li>
<li class="chapter" data-level="10.5" data-path="putting-all-together.html"><a href="putting-all-together.html"><i class="fa fa-check"></i><b>10.5</b> Putting all together</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="putting-all-together.html"><a href="putting-all-together.html#generating-statistics-using-igraph"><i class="fa fa-check"></i><b>10.5.1</b> Generating statistics using igraph</a></li>
<li class="chapter" data-level="10.5.2" data-path="putting-all-together.html"><a href="putting-all-together.html#generating-statistics-based-on-ergm"><i class="fa fa-check"></i><b>10.5.2</b> Generating statistics based on ergm</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="saving-the-data.html"><a href="saving-the-data.html"><i class="fa fa-check"></i><b>10.6</b> Saving the data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hypothesis-testing-in-networks.html"><a href="hypothesis-testing-in-networks.html"><i class="fa fa-check"></i><b>11</b> Hypothesis testing in networks</a>
<ul>
<li class="chapter" data-level="11.1" data-path="comparing-networks.html"><a href="comparing-networks.html"><i class="fa fa-check"></i><b>11.1</b> Comparing networks</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="comparing-networks.html"><a href="comparing-networks.html#network-bootstrap"><i class="fa fa-check"></i><b>11.1.1</b> Network bootstrap</a></li>
<li class="chapter" data-level="11.1.2" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-normal"><i class="fa fa-check"></i><b>11.1.2</b> When the statistic is normal</a></li>
<li class="chapter" data-level="11.1.3" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-not-normal"><i class="fa fa-check"></i><b>11.1.3</b> When the statistic is NOT normal</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>11.2</b> Examples</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="examples.html"><a href="examples.html#average-of-node-level-stats"><i class="fa fa-check"></i><b>11.2.1</b> Average of node-level stats</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="network-diffussion-with-netdiffuser.html"><a href="network-diffussion-with-netdiffuser.html"><i class="fa fa-check"></i><b>12</b> Network diffussion with <code>netdiffuseR</code></a>
<ul>
<li class="chapter" data-level="12.1" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html"><i class="fa fa-check"></i><b>12.1</b> Network diffusion of innovation</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html#diffusion-networks"><i class="fa fa-check"></i><b>12.1.1</b> Diffusion networks</a></li>
<li class="chapter" data-level="12.1.2" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html#thresholds"><i class="fa fa-check"></i><b>12.1.2</b> Thresholds</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html"><i class="fa fa-check"></i><b>12.2</b> The netdiffuseR R package</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#overview"><i class="fa fa-check"></i><b>12.2.1</b> Overview</a></li>
<li class="chapter" data-level="12.2.2" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#datasets"><i class="fa fa-check"></i><b>12.2.2</b> Datasets</a></li>
<li class="chapter" data-level="12.2.3" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#visualization-methods"><i class="fa fa-check"></i><b>12.2.3</b> Visualization methods</a></li>
<li class="chapter" data-level="12.2.4" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#problems"><i class="fa fa-check"></i><b>12.2.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html"><i class="fa fa-check"></i><b>12.3</b> Simulation of diffusion processes</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#simulating-diffusion-networks"><i class="fa fa-check"></i><b>12.3.1</b> Simulating diffusion networks</a></li>
<li class="chapter" data-level="12.3.2" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#rumor-spreading"><i class="fa fa-check"></i><b>12.3.2</b> Rumor spreading</a></li>
<li class="chapter" data-level="12.3.3" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#difussion"><i class="fa fa-check"></i><b>12.3.3</b> Difussion</a></li>
<li class="chapter" data-level="12.3.4" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#mentor-matching"><i class="fa fa-check"></i><b>12.3.4</b> Mentor Matching</a></li>
<li class="chapter" data-level="12.3.5" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#example-by-changing-threshold"><i class="fa fa-check"></i><b>12.3.5</b> Example by changing threshold</a></li>
<li class="chapter" data-level="12.3.6" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#problems-1"><i class="fa fa-check"></i><b>12.3.6</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>12.4</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#morans-i"><i class="fa fa-check"></i><b>12.4.1</b> Moran’s I</a></li>
<li class="chapter" data-level="12.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#using-geodesics"><i class="fa fa-check"></i><b>12.4.2</b> Using geodesics</a></li>
<li class="chapter" data-level="12.4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#structural-dependence-and-permutation-tests"><i class="fa fa-check"></i><b>12.4.3</b> Structural dependence and permutation tests</a></li>
<li class="chapter" data-level="12.4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#idea"><i class="fa fa-check"></i><b>12.4.4</b> Idea</a></li>
<li class="chapter" data-level="12.4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#regression-analysis"><i class="fa fa-check"></i><b>12.4.5</b> Regression analysis</a></li>
<li class="chapter" data-level="12.4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#problems-2"><i class="fa fa-check"></i><b>12.4.6</b> Problems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="stochastic-actor-oriented-models.html"><a href="stochastic-actor-oriented-models.html"><i class="fa fa-check"></i><b>13</b> Stochastic Actor Oriented Models</a></li>
<li class="chapter" data-level="14" data-path="power-calculation-in-network-studies.html"><a href="power-calculation-in-network-studies.html"><i class="fa fa-check"></i><b>14</b> Power calculation in network studies</a>
<ul>
<li class="chapter" data-level="14.1" data-path="example-1-spillover-effects-in-egocentric-studiescredit-ego-power.html"><a href="example-1-spillover-effects-in-egocentric-studiescredit-ego-power.html"><i class="fa fa-check"></i><b>14.1</b> Example 1: Spillover effects in egocentric studies</a></li>
<li class="chapter" data-level="14.2" data-path="example-2-spillover-effects-pre-post-effect.html"><a href="example-2-spillover-effects-pre-post-effect.html"><i class="fa fa-check"></i><b>14.2</b> Example 2: Spillover effects pre-post effect</a></li>
<li class="chapter" data-level="14.3" data-path="example-3-first-difference.html"><a href="example-3-first-difference.html"><i class="fa fa-check"></i><b>14.3</b> Example 3: First difference</a></li>
</ul></li>
<li class="part"><span><b>II Statistical Foundations</b></span></li>
<li class="chapter" data-level="15" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>15</b> Bayes’ Rule</a></li>
<li class="chapter" data-level="16" data-path="markov-chain.html"><a href="markov-chain.html"><i class="fa fa-check"></i><b>16</b> Markov Chain</a>
<ul>
<li class="chapter" data-level="16.1" data-path="metropolis-algorithm.html"><a href="metropolis-algorithm.html"><i class="fa fa-check"></i><b>16.1</b> Metropolis Algorithm</a></li>
<li class="chapter" data-level="16.2" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i><b>16.2</b> Metropolis-Hastings</a></li>
<li class="chapter" data-level="16.3" data-path="likelihood-free-mcmc.html"><a href="likelihood-free-mcmc.html"><i class="fa fa-check"></i><b>16.3</b> Likelihood-free MCMC</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="part2-power.html"><a href="part2-power.html"><i class="fa fa-check"></i><b>17</b> Power and sample size</a>
<ul>
<li class="chapter" data-level="17.1" data-path="error-types.html"><a href="error-types.html"><i class="fa fa-check"></i><b>17.1</b> Error types</a></li>
<li class="chapter" data-level="17.2" data-path="example-1-sample-size-for-a-proportion.html"><a href="example-1-sample-size-for-a-proportion.html"><i class="fa fa-check"></i><b>17.2</b> Example 1: Sample size for a proportion</a></li>
<li class="chapter" data-level="17.3" data-path="example-2-sample-size-for-a-proportion-vis.html"><a href="example-2-sample-size-for-a-proportion-vis.html"><i class="fa fa-check"></i><b>17.3</b> Example 2: Sample size for a proportion (vis)</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="datasets-1.html"><a href="datasets-1.html"><i class="fa fa-check"></i><b>A</b> Datasets</a>
<ul>
<li class="chapter" data-level="A.1" data-path="sns-data.html"><a href="sns-data.html"><i class="fa fa-check"></i><b>A.1</b> SNS data</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="sns-data.html"><a href="sns-data.html#about-the-data"><i class="fa fa-check"></i><b>A.1.1</b> About the data</a></li>
<li class="chapter" data-level="A.1.2" data-path="sns-data.html"><a href="sns-data.html#variables"><i class="fa fa-check"></i><b>A.1.2</b> Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Network Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-goodness-of-fit" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Model Goodness-of-Fit<a href="model-goodness-of-fit.html#model-goodness-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In raw terms, once each chain has reach stationary distribution, we can say that there are no problems with autocorrelation and that each sample point is iid. This implies that, since we are running the model with more than 1 chain, we can use all the samples (chains) as a single dataset.</p>
<blockquote>
<p>Recent changes in the ergm estimation algorithm mean that these plots can no longer be used to ensure that the mean statistics from the model match the observed network statistics. For that functionality, please use the GOF command: gof(object, GOF=~model).</p>
<p>—?ergm::mcmc.diagnostics</p>
</blockquote>
<p>Since <code>ans0</code> is the one model which did best, let’s take a look at it’s GOF statistics. First, lets see how the MCMC did. For this we can use the <code>mcmc.diagnostics</code> function including in the package. This function is actually a wrapper of a couple of functions from the <code>coda</code> package <span class="citation">(<a href="#ref-R-coda">Plummer et al. 2006</a>)</span> which is called upon the <code>$sample</code> object which holds the <em>centered</em> statistics from the sampled networks. This last point is important to consider since at first look it can be confusing to look at the <code>$sample</code> object since it neither matches the observed statistics, nor the coefficients.</p>
<p>When calling the function <code>mcmc.diagnostics(ans0, centered = FALSE)</code>, you will see a lot of output including a couple of plots showing the trace and posterior distribution of the <em>uncentered</em> statistics (<code>centered = FALSE</code>). In the next code chunks we will reproduce the output from the <code>mcmc.diagnostics</code> function step by step using the coda package. First we need to <em>uncenter</em> the sample object:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="model-goodness-of-fit.html#cb146-1" tabindex="-1"></a><span class="co"># Getting the centered sample</span></span>
<span id="cb146-2"><a href="model-goodness-of-fit.html#cb146-2" tabindex="-1"></a>sample_centered <span class="ot">&lt;-</span> ans0<span class="sc">$</span>sample</span>
<span id="cb146-3"><a href="model-goodness-of-fit.html#cb146-3" tabindex="-1"></a></span>
<span id="cb146-4"><a href="model-goodness-of-fit.html#cb146-4" tabindex="-1"></a><span class="co"># Getting the observed statistics and turning it into a matrix so we can add it</span></span>
<span id="cb146-5"><a href="model-goodness-of-fit.html#cb146-5" tabindex="-1"></a><span class="co"># to the samples</span></span>
<span id="cb146-6"><a href="model-goodness-of-fit.html#cb146-6" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">summary</span>(ans0<span class="sc">$</span>formula)</span>
<span id="cb146-7"><a href="model-goodness-of-fit.html#cb146-7" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb146-8"><a href="model-goodness-of-fit.html#cb146-8" tabindex="-1"></a>  observed,</span>
<span id="cb146-9"><a href="model-goodness-of-fit.html#cb146-9" tabindex="-1"></a>  <span class="at">nrow  =</span> <span class="fu">nrow</span>(sample_centered[[<span class="dv">1</span>]]),</span>
<span id="cb146-10"><a href="model-goodness-of-fit.html#cb146-10" tabindex="-1"></a>  <span class="at">ncol  =</span> <span class="fu">length</span>(observed),</span>
<span id="cb146-11"><a href="model-goodness-of-fit.html#cb146-11" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb146-12"><a href="model-goodness-of-fit.html#cb146-12" tabindex="-1"></a>  )</span>
<span id="cb146-13"><a href="model-goodness-of-fit.html#cb146-13" tabindex="-1"></a></span>
<span id="cb146-14"><a href="model-goodness-of-fit.html#cb146-14" tabindex="-1"></a><span class="co"># Now we uncenter the sample</span></span>
<span id="cb146-15"><a href="model-goodness-of-fit.html#cb146-15" tabindex="-1"></a>sample_uncentered <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sample_centered, <span class="cf">function</span>(x) {</span>
<span id="cb146-16"><a href="model-goodness-of-fit.html#cb146-16" tabindex="-1"></a>  x <span class="sc">+</span> observed</span>
<span id="cb146-17"><a href="model-goodness-of-fit.html#cb146-17" tabindex="-1"></a>})</span>
<span id="cb146-18"><a href="model-goodness-of-fit.html#cb146-18" tabindex="-1"></a></span>
<span id="cb146-19"><a href="model-goodness-of-fit.html#cb146-19" tabindex="-1"></a><span class="co"># We have to make it an mcmc.list object</span></span>
<span id="cb146-20"><a href="model-goodness-of-fit.html#cb146-20" tabindex="-1"></a>sample_uncentered <span class="ot">&lt;-</span> coda<span class="sc">::</span><span class="fu">mcmc.list</span>(sample_uncentered)</span></code></pre></div>
<p>Under the hood:</p>
<ol style="list-style-type: decimal">
<li><p><em>Empirical means and sd, and quantiles</em>:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="model-goodness-of-fit.html#cb147-1" tabindex="-1"></a><span class="fu">summary</span>(sample_uncentered)</span>
<span id="cb147-2"><a href="model-goodness-of-fit.html#cb147-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb147-3"><a href="model-goodness-of-fit.html#cb147-3" tabindex="-1"></a><span class="do">## Iterations = 1769472:10944512</span></span>
<span id="cb147-4"><a href="model-goodness-of-fit.html#cb147-4" tabindex="-1"></a><span class="do">## Thinning interval = 65536 </span></span>
<span id="cb147-5"><a href="model-goodness-of-fit.html#cb147-5" tabindex="-1"></a><span class="do">## Number of chains = 4 </span></span>
<span id="cb147-6"><a href="model-goodness-of-fit.html#cb147-6" tabindex="-1"></a><span class="do">## Sample size per chain = 141 </span></span>
<span id="cb147-7"><a href="model-goodness-of-fit.html#cb147-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb147-8"><a href="model-goodness-of-fit.html#cb147-8" tabindex="-1"></a><span class="do">## 1. Empirical mean and standard deviation for each variable,</span></span>
<span id="cb147-9"><a href="model-goodness-of-fit.html#cb147-9" tabindex="-1"></a><span class="do">##    plus standard error of the mean:</span></span>
<span id="cb147-10"><a href="model-goodness-of-fit.html#cb147-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb147-11"><a href="model-goodness-of-fit.html#cb147-11" tabindex="-1"></a><span class="do">##                    Mean    SD Naive SE Time-series SE</span></span>
<span id="cb147-12"><a href="model-goodness-of-fit.html#cb147-12" tabindex="-1"></a><span class="do">## edges              2485 60.26   2.5372          3.753</span></span>
<span id="cb147-13"><a href="model-goodness-of-fit.html#cb147-13" tabindex="-1"></a><span class="do">## nodematch.hispanic 1838 51.25   2.1578          3.662</span></span>
<span id="cb147-14"><a href="model-goodness-of-fit.html#cb147-14" tabindex="-1"></a><span class="do">## nodematch.female1  1888 52.78   2.2224          3.779</span></span>
<span id="cb147-15"><a href="model-goodness-of-fit.html#cb147-15" tabindex="-1"></a><span class="do">## nodematch.eversmk1 1759 50.82   2.1400          3.072</span></span>
<span id="cb147-16"><a href="model-goodness-of-fit.html#cb147-16" tabindex="-1"></a><span class="do">## mutual              493 23.40   0.9855          1.967</span></span>
<span id="cb147-17"><a href="model-goodness-of-fit.html#cb147-17" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb147-18"><a href="model-goodness-of-fit.html#cb147-18" tabindex="-1"></a><span class="do">## 2. Quantiles for each variable:</span></span>
<span id="cb147-19"><a href="model-goodness-of-fit.html#cb147-19" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb147-20"><a href="model-goodness-of-fit.html#cb147-20" tabindex="-1"></a><span class="do">##                    2.5%  25%  50%  75% 97.5%</span></span>
<span id="cb147-21"><a href="model-goodness-of-fit.html#cb147-21" tabindex="-1"></a><span class="do">## edges              2373 2444 2482 2530  2612</span></span>
<span id="cb147-22"><a href="model-goodness-of-fit.html#cb147-22" tabindex="-1"></a><span class="do">## nodematch.hispanic 1736 1803 1839 1872  1947</span></span>
<span id="cb147-23"><a href="model-goodness-of-fit.html#cb147-23" tabindex="-1"></a><span class="do">## nodematch.female1  1791 1851 1885 1923  1993</span></span>
<span id="cb147-24"><a href="model-goodness-of-fit.html#cb147-24" tabindex="-1"></a><span class="do">## nodematch.eversmk1 1662 1725 1758 1794  1858</span></span>
<span id="cb147-25"><a href="model-goodness-of-fit.html#cb147-25" tabindex="-1"></a><span class="do">## mutual              449  476  493  509   537</span></span></code></pre></div></li>
<li><p><em>Cross correlation</em>:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="model-goodness-of-fit.html#cb148-1" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">crosscorr</span>(sample_uncentered)</span>
<span id="cb148-2"><a href="model-goodness-of-fit.html#cb148-2" tabindex="-1"></a><span class="do">##                        edges nodematch.hispanic nodematch.female1</span></span>
<span id="cb148-3"><a href="model-goodness-of-fit.html#cb148-3" tabindex="-1"></a><span class="do">## edges              1.0000000          0.8657369         0.8851587</span></span>
<span id="cb148-4"><a href="model-goodness-of-fit.html#cb148-4" tabindex="-1"></a><span class="do">## nodematch.hispanic 0.8657369          1.0000000         0.7713632</span></span>
<span id="cb148-5"><a href="model-goodness-of-fit.html#cb148-5" tabindex="-1"></a><span class="do">## nodematch.female1  0.8851587          0.7713632         1.0000000</span></span>
<span id="cb148-6"><a href="model-goodness-of-fit.html#cb148-6" tabindex="-1"></a><span class="do">## nodematch.eversmk1 0.8445651          0.7122693         0.7572735</span></span>
<span id="cb148-7"><a href="model-goodness-of-fit.html#cb148-7" tabindex="-1"></a><span class="do">## mutual             0.7726517          0.6801783         0.7482026</span></span>
<span id="cb148-8"><a href="model-goodness-of-fit.html#cb148-8" tabindex="-1"></a><span class="do">##                    nodematch.eversmk1    mutual</span></span>
<span id="cb148-9"><a href="model-goodness-of-fit.html#cb148-9" tabindex="-1"></a><span class="do">## edges                       0.8445651 0.7726517</span></span>
<span id="cb148-10"><a href="model-goodness-of-fit.html#cb148-10" tabindex="-1"></a><span class="do">## nodematch.hispanic          0.7122693 0.6801783</span></span>
<span id="cb148-11"><a href="model-goodness-of-fit.html#cb148-11" tabindex="-1"></a><span class="do">## nodematch.female1           0.7572735 0.7482026</span></span>
<span id="cb148-12"><a href="model-goodness-of-fit.html#cb148-12" tabindex="-1"></a><span class="do">## nodematch.eversmk1          1.0000000 0.6873242</span></span>
<span id="cb148-13"><a href="model-goodness-of-fit.html#cb148-13" tabindex="-1"></a><span class="do">## mutual                      0.6873242 1.0000000</span></span></code></pre></div></li>
<li><p><em>Autocorrelation</em>: For now, we will only look at autocorrelation for chain one. Autocorrelation should be small (in a general MCMC setting). If autocorrelation is high, then it means that your sample is not idd (no Markov property). A way out to solve this is <em>thinning</em> the sample.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="model-goodness-of-fit.html#cb149-1" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">autocorr</span>(sample_uncentered)[[<span class="dv">1</span>]]</span>
<span id="cb149-2"><a href="model-goodness-of-fit.html#cb149-2" tabindex="-1"></a><span class="do">## , , edges</span></span>
<span id="cb149-3"><a href="model-goodness-of-fit.html#cb149-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb149-4"><a href="model-goodness-of-fit.html#cb149-4" tabindex="-1"></a><span class="do">##                   edges nodematch.hispanic nodematch.female1 nodematch.eversmk1</span></span>
<span id="cb149-5"><a href="model-goodness-of-fit.html#cb149-5" tabindex="-1"></a><span class="do">## Lag 0       1.000000000        0.861920590        0.90235072         0.86215333</span></span>
<span id="cb149-6"><a href="model-goodness-of-fit.html#cb149-6" tabindex="-1"></a><span class="do">## Lag 65536   0.415060923        0.326775063        0.43751588         0.38274418</span></span>
<span id="cb149-7"><a href="model-goodness-of-fit.html#cb149-7" tabindex="-1"></a><span class="do">## Lag 327680  0.063993999        0.002238453        0.09094189         0.05143792</span></span>
<span id="cb149-8"><a href="model-goodness-of-fit.html#cb149-8" tabindex="-1"></a><span class="do">## Lag 655360  0.002497326       -0.105210070       -0.02414091         0.00143358</span></span>
<span id="cb149-9"><a href="model-goodness-of-fit.html#cb149-9" tabindex="-1"></a><span class="do">## Lag 3276800 0.026845190        0.068616366        0.03686125         0.03652383</span></span>
<span id="cb149-10"><a href="model-goodness-of-fit.html#cb149-10" tabindex="-1"></a><span class="do">##                  mutual</span></span>
<span id="cb149-11"><a href="model-goodness-of-fit.html#cb149-11" tabindex="-1"></a><span class="do">## Lag 0       0.785264416</span></span>
<span id="cb149-12"><a href="model-goodness-of-fit.html#cb149-12" tabindex="-1"></a><span class="do">## Lag 65536   0.428519050</span></span>
<span id="cb149-13"><a href="model-goodness-of-fit.html#cb149-13" tabindex="-1"></a><span class="do">## Lag 327680  0.074020671</span></span>
<span id="cb149-14"><a href="model-goodness-of-fit.html#cb149-14" tabindex="-1"></a><span class="do">## Lag 655360  0.009422505</span></span>
<span id="cb149-15"><a href="model-goodness-of-fit.html#cb149-15" tabindex="-1"></a><span class="do">## Lag 3276800 0.018126669</span></span>
<span id="cb149-16"><a href="model-goodness-of-fit.html#cb149-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb149-17"><a href="model-goodness-of-fit.html#cb149-17" tabindex="-1"></a><span class="do">## , , nodematch.hispanic</span></span>
<span id="cb149-18"><a href="model-goodness-of-fit.html#cb149-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb149-19"><a href="model-goodness-of-fit.html#cb149-19" tabindex="-1"></a><span class="do">##                   edges nodematch.hispanic nodematch.female1 nodematch.eversmk1</span></span>
<span id="cb149-20"><a href="model-goodness-of-fit.html#cb149-20" tabindex="-1"></a><span class="do">## Lag 0        0.86192059        1.000000000        0.76137201         0.74623272</span></span>
<span id="cb149-21"><a href="model-goodness-of-fit.html#cb149-21" tabindex="-1"></a><span class="do">## Lag 65536    0.32680263        0.336764054        0.30353156         0.32690588</span></span>
<span id="cb149-22"><a href="model-goodness-of-fit.html#cb149-22" tabindex="-1"></a><span class="do">## Lag 327680   0.05778076        0.004465856        0.07267341         0.03757479</span></span>
<span id="cb149-23"><a href="model-goodness-of-fit.html#cb149-23" tabindex="-1"></a><span class="do">## Lag 655360   0.07704457        0.024226503        0.03252125         0.08420548</span></span>
<span id="cb149-24"><a href="model-goodness-of-fit.html#cb149-24" tabindex="-1"></a><span class="do">## Lag 3276800 -0.02970399        0.021278122       -0.02753467        -0.03018601</span></span>
<span id="cb149-25"><a href="model-goodness-of-fit.html#cb149-25" tabindex="-1"></a><span class="do">##                  mutual</span></span>
<span id="cb149-26"><a href="model-goodness-of-fit.html#cb149-26" tabindex="-1"></a><span class="do">## Lag 0        0.70578514</span></span>
<span id="cb149-27"><a href="model-goodness-of-fit.html#cb149-27" tabindex="-1"></a><span class="do">## Lag 65536    0.35558587</span></span>
<span id="cb149-28"><a href="model-goodness-of-fit.html#cb149-28" tabindex="-1"></a><span class="do">## Lag 327680   0.05282736</span></span>
<span id="cb149-29"><a href="model-goodness-of-fit.html#cb149-29" tabindex="-1"></a><span class="do">## Lag 655360   0.08176601</span></span>
<span id="cb149-30"><a href="model-goodness-of-fit.html#cb149-30" tabindex="-1"></a><span class="do">## Lag 3276800 -0.07743174</span></span>
<span id="cb149-31"><a href="model-goodness-of-fit.html#cb149-31" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb149-32"><a href="model-goodness-of-fit.html#cb149-32" tabindex="-1"></a><span class="do">## , , nodematch.female1</span></span>
<span id="cb149-33"><a href="model-goodness-of-fit.html#cb149-33" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb149-34"><a href="model-goodness-of-fit.html#cb149-34" tabindex="-1"></a><span class="do">##                   edges nodematch.hispanic nodematch.female1 nodematch.eversmk1</span></span>
<span id="cb149-35"><a href="model-goodness-of-fit.html#cb149-35" tabindex="-1"></a><span class="do">## Lag 0       0.902350724         0.76137201        1.00000000         0.77769826</span></span>
<span id="cb149-36"><a href="model-goodness-of-fit.html#cb149-36" tabindex="-1"></a><span class="do">## Lag 65536   0.453418914         0.37756721        0.51290498         0.41954866</span></span>
<span id="cb149-37"><a href="model-goodness-of-fit.html#cb149-37" tabindex="-1"></a><span class="do">## Lag 327680  0.055464012        -0.01058737        0.09841770         0.04272154</span></span>
<span id="cb149-38"><a href="model-goodness-of-fit.html#cb149-38" tabindex="-1"></a><span class="do">## Lag 655360  0.009910833        -0.06123858       -0.03186870         0.04679847</span></span>
<span id="cb149-39"><a href="model-goodness-of-fit.html#cb149-39" tabindex="-1"></a><span class="do">## Lag 3276800 0.004163166         0.04057544        0.01548719        -0.01288236</span></span>
<span id="cb149-40"><a href="model-goodness-of-fit.html#cb149-40" tabindex="-1"></a><span class="do">##                  mutual</span></span>
<span id="cb149-41"><a href="model-goodness-of-fit.html#cb149-41" tabindex="-1"></a><span class="do">## Lag 0        0.76981085</span></span>
<span id="cb149-42"><a href="model-goodness-of-fit.html#cb149-42" tabindex="-1"></a><span class="do">## Lag 65536    0.46327442</span></span>
<span id="cb149-43"><a href="model-goodness-of-fit.html#cb149-43" tabindex="-1"></a><span class="do">## Lag 327680   0.03629824</span></span>
<span id="cb149-44"><a href="model-goodness-of-fit.html#cb149-44" tabindex="-1"></a><span class="do">## Lag 655360   0.01987496</span></span>
<span id="cb149-45"><a href="model-goodness-of-fit.html#cb149-45" tabindex="-1"></a><span class="do">## Lag 3276800 -0.00949882</span></span>
<span id="cb149-46"><a href="model-goodness-of-fit.html#cb149-46" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb149-47"><a href="model-goodness-of-fit.html#cb149-47" tabindex="-1"></a><span class="do">## , , nodematch.eversmk1</span></span>
<span id="cb149-48"><a href="model-goodness-of-fit.html#cb149-48" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb149-49"><a href="model-goodness-of-fit.html#cb149-49" tabindex="-1"></a><span class="do">##                  edges nodematch.hispanic nodematch.female1 nodematch.eversmk1</span></span>
<span id="cb149-50"><a href="model-goodness-of-fit.html#cb149-50" tabindex="-1"></a><span class="do">## Lag 0       0.86215333        0.746232721        0.77769826        1.000000000</span></span>
<span id="cb149-51"><a href="model-goodness-of-fit.html#cb149-51" tabindex="-1"></a><span class="do">## Lag 65536   0.37539678        0.297591397        0.41717478        0.448697559</span></span>
<span id="cb149-52"><a href="model-goodness-of-fit.html#cb149-52" tabindex="-1"></a><span class="do">## Lag 327680  0.02105523       -0.040132752        0.03760486        0.019124328</span></span>
<span id="cb149-53"><a href="model-goodness-of-fit.html#cb149-53" tabindex="-1"></a><span class="do">## Lag 655360  0.04566425        0.003387581        0.04761067       -0.006388743</span></span>
<span id="cb149-54"><a href="model-goodness-of-fit.html#cb149-54" tabindex="-1"></a><span class="do">## Lag 3276800 0.05048735        0.084790008        0.07108989        0.045582057</span></span>
<span id="cb149-55"><a href="model-goodness-of-fit.html#cb149-55" tabindex="-1"></a><span class="do">##                   mutual</span></span>
<span id="cb149-56"><a href="model-goodness-of-fit.html#cb149-56" tabindex="-1"></a><span class="do">## Lag 0       0.7053009595</span></span>
<span id="cb149-57"><a href="model-goodness-of-fit.html#cb149-57" tabindex="-1"></a><span class="do">## Lag 65536   0.4020746950</span></span>
<span id="cb149-58"><a href="model-goodness-of-fit.html#cb149-58" tabindex="-1"></a><span class="do">## Lag 327680  0.0183308894</span></span>
<span id="cb149-59"><a href="model-goodness-of-fit.html#cb149-59" tabindex="-1"></a><span class="do">## Lag 655360  0.0840948296</span></span>
<span id="cb149-60"><a href="model-goodness-of-fit.html#cb149-60" tabindex="-1"></a><span class="do">## Lag 3276800 0.0009713556</span></span>
<span id="cb149-61"><a href="model-goodness-of-fit.html#cb149-61" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb149-62"><a href="model-goodness-of-fit.html#cb149-62" tabindex="-1"></a><span class="do">## , , mutual</span></span>
<span id="cb149-63"><a href="model-goodness-of-fit.html#cb149-63" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb149-64"><a href="model-goodness-of-fit.html#cb149-64" tabindex="-1"></a><span class="do">##                   edges nodematch.hispanic nodematch.female1 nodematch.eversmk1</span></span>
<span id="cb149-65"><a href="model-goodness-of-fit.html#cb149-65" tabindex="-1"></a><span class="do">## Lag 0        0.78526442         0.70578514       0.769810849         0.70530096</span></span>
<span id="cb149-66"><a href="model-goodness-of-fit.html#cb149-66" tabindex="-1"></a><span class="do">## Lag 65536    0.50645801         0.44741607       0.532817503         0.47751208</span></span>
<span id="cb149-67"><a href="model-goodness-of-fit.html#cb149-67" tabindex="-1"></a><span class="do">## Lag 327680   0.12979152         0.06061696       0.147380566         0.10930214</span></span>
<span id="cb149-68"><a href="model-goodness-of-fit.html#cb149-68" tabindex="-1"></a><span class="do">## Lag 655360  -0.06393205        -0.13217821      -0.008121728        -0.03814393</span></span>
<span id="cb149-69"><a href="model-goodness-of-fit.html#cb149-69" tabindex="-1"></a><span class="do">## Lag 3276800 -0.01707605         0.03244214      -0.023750630         0.02781638</span></span>
<span id="cb149-70"><a href="model-goodness-of-fit.html#cb149-70" tabindex="-1"></a><span class="do">##                   mutual</span></span>
<span id="cb149-71"><a href="model-goodness-of-fit.html#cb149-71" tabindex="-1"></a><span class="do">## Lag 0        1.000000000</span></span>
<span id="cb149-72"><a href="model-goodness-of-fit.html#cb149-72" tabindex="-1"></a><span class="do">## Lag 65536    0.580271013</span></span>
<span id="cb149-73"><a href="model-goodness-of-fit.html#cb149-73" tabindex="-1"></a><span class="do">## Lag 327680   0.091309576</span></span>
<span id="cb149-74"><a href="model-goodness-of-fit.html#cb149-74" tabindex="-1"></a><span class="do">## Lag 655360  -0.003521212</span></span>
<span id="cb149-75"><a href="model-goodness-of-fit.html#cb149-75" tabindex="-1"></a><span class="do">## Lag 3276800 -0.025558756</span></span></code></pre></div></li>
<li><p><em>Geweke Diagnostic</em>: From the function’s help file:</p>
<blockquote>
<p>“If the samples are drawn from the stationary distribution of the chain, the two means are equal and Geweke’s statistic has an asymptotically standard normal distribution. […]
The Z-score is calculated under the assumption that the two parts of the chain are asymptotically independent, which requires that the sum of frac1 and frac2 be strictly less than 1.””</p>
<p>—?coda::geweke.diag</p>
</blockquote>
<p>Let’s take a look at a single chain:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="model-goodness-of-fit.html#cb150-1" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">geweke.diag</span>(sample_uncentered)[[<span class="dv">1</span>]]</span>
<span id="cb150-2"><a href="model-goodness-of-fit.html#cb150-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb150-3"><a href="model-goodness-of-fit.html#cb150-3" tabindex="-1"></a><span class="do">## Fraction in 1st window = 0.1</span></span>
<span id="cb150-4"><a href="model-goodness-of-fit.html#cb150-4" tabindex="-1"></a><span class="do">## Fraction in 2nd window = 0.5 </span></span>
<span id="cb150-5"><a href="model-goodness-of-fit.html#cb150-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb150-6"><a href="model-goodness-of-fit.html#cb150-6" tabindex="-1"></a><span class="do">##              edges nodematch.hispanic  nodematch.female1 nodematch.eversmk1 </span></span>
<span id="cb150-7"><a href="model-goodness-of-fit.html#cb150-7" tabindex="-1"></a><span class="do">##            -0.7115            -1.7204            -0.1841             0.6952 </span></span>
<span id="cb150-8"><a href="model-goodness-of-fit.html#cb150-8" tabindex="-1"></a><span class="do">##             mutual </span></span>
<span id="cb150-9"><a href="model-goodness-of-fit.html#cb150-9" tabindex="-1"></a><span class="do">##            -1.2891</span></span></code></pre></div></li>
<li><p><em>(not included) Gelman Diagnostic</em>: From the function’s help file:</p>
<blockquote>
<p>Gelman and Rubin (1992) propose a general approach to monitoring convergence of MCMC output in which m &gt; 1 parallel chains are run with starting values that are overdispersed relative to the posterior distribution. Convergence is diagnosed when the chains have ‘forgotten’ their initial values, and the output from all chains is indistinguishable. The gelman.diag diagnostic is applied to a single variable from the chain. It is based a comparison of within-chain and between-chain variances, and is similar to a classical analysis of variance.
—?coda::gelman.diag</p>
</blockquote>
<p>As a difference from the previous diagnostic statistic, this uses all chains simulatenously:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="model-goodness-of-fit.html#cb151-1" tabindex="-1"></a>coda<span class="sc">::</span><span class="fu">gelman.diag</span>(sample_uncentered)</span>
<span id="cb151-2"><a href="model-goodness-of-fit.html#cb151-2" tabindex="-1"></a><span class="do">## Potential scale reduction factors:</span></span>
<span id="cb151-3"><a href="model-goodness-of-fit.html#cb151-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb151-4"><a href="model-goodness-of-fit.html#cb151-4" tabindex="-1"></a><span class="do">##                    Point est. Upper C.I.</span></span>
<span id="cb151-5"><a href="model-goodness-of-fit.html#cb151-5" tabindex="-1"></a><span class="do">## edges                    1.03       1.10</span></span>
<span id="cb151-6"><a href="model-goodness-of-fit.html#cb151-6" tabindex="-1"></a><span class="do">## nodematch.hispanic       1.03       1.10</span></span>
<span id="cb151-7"><a href="model-goodness-of-fit.html#cb151-7" tabindex="-1"></a><span class="do">## nodematch.female1        1.05       1.14</span></span>
<span id="cb151-8"><a href="model-goodness-of-fit.html#cb151-8" tabindex="-1"></a><span class="do">## nodematch.eversmk1       1.04       1.12</span></span>
<span id="cb151-9"><a href="model-goodness-of-fit.html#cb151-9" tabindex="-1"></a><span class="do">## mutual                   1.05       1.14</span></span>
<span id="cb151-10"><a href="model-goodness-of-fit.html#cb151-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb151-11"><a href="model-goodness-of-fit.html#cb151-11" tabindex="-1"></a><span class="do">## Multivariate psrf</span></span>
<span id="cb151-12"><a href="model-goodness-of-fit.html#cb151-12" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb151-13"><a href="model-goodness-of-fit.html#cb151-13" tabindex="-1"></a><span class="do">## 1.05</span></span></code></pre></div>
<p>As a rule of thumb, values that are in the <span class="math inline">\([.9,1.1]\)</span> are good.</p></li>
</ol>
<p>One nice feature of the <code>mcmc.diagnostics</code> function is the nice trace and posterior distribution plots that it generates. If you have the R package <code>latticeExtra</code> <span class="citation">(<a href="#ref-R-latticeExtra">Sarkar and Andrews 2016</a>)</span>, the function will override the default plots used by <code>coda::plot.mcmc</code> and use lattice instead, creating a nicer looking plots. The next code chunk calls the <code>mcmc.diagnostic</code> function, but we suppress the rest of the output (see figure <a href="#fig:coda-plots"><strong>??</strong></a>).</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="model-goodness-of-fit.html#cb152-1" tabindex="-1"></a><span class="co"># [2022-03-13] This line is failing for what it could be an ergm bug</span></span>
<span id="cb152-2"><a href="model-goodness-of-fit.html#cb152-2" tabindex="-1"></a><span class="co"># mcmc.diagnostics(ans0, center = FALSE) # Suppressing all the output</span></span></code></pre></div>
<p>If we called the function <code>mcmc.diagnostics</code>, this message appears at the end:</p>
<blockquote>
<p>MCMC diagnostics shown here are from the last round of simulation, prior to computation of final parameter estimates. Because the final estimates are refinements of those used for this simulation run, these diagnostics may understate model performance. To directly assess the performance of the final model on in-model statistics, please use the GOF command: gof(ergmFitObject, GOF=~model).</p>
<p>—<code>mcmc.diagnostics(ans0)</code></p>
</blockquote>
<p>Not that bad (although the <code>mutual</code> term could do better)!<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a> First, observe that in the figure we see four different lines; why is that? Since we were running in parallel using four cores, the algorithm ran four chains of the MCMC algorithm. An eyeball test is to see if all the chains moved at about the same place; in such a case, we can start thinking about model convergence from the MCMC perspective.</p>
<p>Once we are sure to have reach convergence on the MCMC algorithm, we can start thinking about how well does our model predicts the observed network’s proterties. Besides the statistics that define our ERGM, the <code>gof</code> function’s default behavior show GOF for:</p>
<ol style="list-style-type: lower-alpha">
<li>In degree distribution,</li>
<li>Out degree distribution,</li>
<li>Edge-wise shared partners, and</li>
<li>Geodesics</li>
</ol>
<p>Let’s take a look at it</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="model-goodness-of-fit.html#cb153-1" tabindex="-1"></a><span class="co"># Computing and printing GOF estatistics</span></span>
<span id="cb153-2"><a href="model-goodness-of-fit.html#cb153-2" tabindex="-1"></a>ans_gof <span class="ot">&lt;-</span> <span class="fu">gof</span>(ans0)</span>
<span id="cb153-3"><a href="model-goodness-of-fit.html#cb153-3" tabindex="-1"></a>ans_gof</span>
<span id="cb153-4"><a href="model-goodness-of-fit.html#cb153-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-5"><a href="model-goodness-of-fit.html#cb153-5" tabindex="-1"></a><span class="do">## Goodness-of-fit for in-degree </span></span>
<span id="cb153-6"><a href="model-goodness-of-fit.html#cb153-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-7"><a href="model-goodness-of-fit.html#cb153-7" tabindex="-1"></a><span class="do">##           obs min  mean max MC p-value</span></span>
<span id="cb153-8"><a href="model-goodness-of-fit.html#cb153-8" tabindex="-1"></a><span class="do">## idegree0   13   0  1.38   5       0.00</span></span>
<span id="cb153-9"><a href="model-goodness-of-fit.html#cb153-9" tabindex="-1"></a><span class="do">## idegree1   34   2  7.84  15       0.00</span></span>
<span id="cb153-10"><a href="model-goodness-of-fit.html#cb153-10" tabindex="-1"></a><span class="do">## idegree2   37  13 22.13  36       0.00</span></span>
<span id="cb153-11"><a href="model-goodness-of-fit.html#cb153-11" tabindex="-1"></a><span class="do">## idegree3   48  26 40.12  60       0.12</span></span>
<span id="cb153-12"><a href="model-goodness-of-fit.html#cb153-12" tabindex="-1"></a><span class="do">## idegree4   37  44 59.60  74       0.00</span></span>
<span id="cb153-13"><a href="model-goodness-of-fit.html#cb153-13" tabindex="-1"></a><span class="do">## idegree5   47  52 67.86  89       0.00</span></span>
<span id="cb153-14"><a href="model-goodness-of-fit.html#cb153-14" tabindex="-1"></a><span class="do">## idegree6   42  48 65.06  82       0.00</span></span>
<span id="cb153-15"><a href="model-goodness-of-fit.html#cb153-15" tabindex="-1"></a><span class="do">## idegree7   39  38 53.40  69       0.04</span></span>
<span id="cb153-16"><a href="model-goodness-of-fit.html#cb153-16" tabindex="-1"></a><span class="do">## idegree8   35  26 40.30  57       0.46</span></span>
<span id="cb153-17"><a href="model-goodness-of-fit.html#cb153-17" tabindex="-1"></a><span class="do">## idegree9   21  17 26.48  43       0.36</span></span>
<span id="cb153-18"><a href="model-goodness-of-fit.html#cb153-18" tabindex="-1"></a><span class="do">## idegree10  12   9 16.36  24       0.34</span></span>
<span id="cb153-19"><a href="model-goodness-of-fit.html#cb153-19" tabindex="-1"></a><span class="do">## idegree11  19   2  8.73  15       0.00</span></span>
<span id="cb153-20"><a href="model-goodness-of-fit.html#cb153-20" tabindex="-1"></a><span class="do">## idegree12   4   0  4.80  13       1.00</span></span>
<span id="cb153-21"><a href="model-goodness-of-fit.html#cb153-21" tabindex="-1"></a><span class="do">## idegree13   7   0  2.23   6       0.00</span></span>
<span id="cb153-22"><a href="model-goodness-of-fit.html#cb153-22" tabindex="-1"></a><span class="do">## idegree14   6   0  0.99   4       0.00</span></span>
<span id="cb153-23"><a href="model-goodness-of-fit.html#cb153-23" tabindex="-1"></a><span class="do">## idegree15   3   0  0.32   2       0.00</span></span>
<span id="cb153-24"><a href="model-goodness-of-fit.html#cb153-24" tabindex="-1"></a><span class="do">## idegree16   4   0  0.20   2       0.00</span></span>
<span id="cb153-25"><a href="model-goodness-of-fit.html#cb153-25" tabindex="-1"></a><span class="do">## idegree17   3   0  0.09   1       0.00</span></span>
<span id="cb153-26"><a href="model-goodness-of-fit.html#cb153-26" tabindex="-1"></a><span class="do">## idegree18   3   0  0.09   1       0.00</span></span>
<span id="cb153-27"><a href="model-goodness-of-fit.html#cb153-27" tabindex="-1"></a><span class="do">## idegree19   2   0  0.00   0       0.00</span></span>
<span id="cb153-28"><a href="model-goodness-of-fit.html#cb153-28" tabindex="-1"></a><span class="do">## idegree20   1   0  0.02   1       0.04</span></span>
<span id="cb153-29"><a href="model-goodness-of-fit.html#cb153-29" tabindex="-1"></a><span class="do">## idegree22   1   0  0.00   0       0.00</span></span>
<span id="cb153-30"><a href="model-goodness-of-fit.html#cb153-30" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-31"><a href="model-goodness-of-fit.html#cb153-31" tabindex="-1"></a><span class="do">## Goodness-of-fit for out-degree </span></span>
<span id="cb153-32"><a href="model-goodness-of-fit.html#cb153-32" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-33"><a href="model-goodness-of-fit.html#cb153-33" tabindex="-1"></a><span class="do">##           obs min  mean max MC p-value</span></span>
<span id="cb153-34"><a href="model-goodness-of-fit.html#cb153-34" tabindex="-1"></a><span class="do">## odegree0    4   0  1.33   6       0.14</span></span>
<span id="cb153-35"><a href="model-goodness-of-fit.html#cb153-35" tabindex="-1"></a><span class="do">## odegree1   28   2  7.67  15       0.00</span></span>
<span id="cb153-36"><a href="model-goodness-of-fit.html#cb153-36" tabindex="-1"></a><span class="do">## odegree2   45  13 22.07  33       0.00</span></span>
<span id="cb153-37"><a href="model-goodness-of-fit.html#cb153-37" tabindex="-1"></a><span class="do">## odegree3   50  27 40.96  55       0.16</span></span>
<span id="cb153-38"><a href="model-goodness-of-fit.html#cb153-38" tabindex="-1"></a><span class="do">## odegree4   54  44 59.37  75       0.50</span></span>
<span id="cb153-39"><a href="model-goodness-of-fit.html#cb153-39" tabindex="-1"></a><span class="do">## odegree5   62  40 67.12  92       0.62</span></span>
<span id="cb153-40"><a href="model-goodness-of-fit.html#cb153-40" tabindex="-1"></a><span class="do">## odegree6   40  46 64.49  81       0.00</span></span>
<span id="cb153-41"><a href="model-goodness-of-fit.html#cb153-41" tabindex="-1"></a><span class="do">## odegree7   28  39 54.33  78       0.00</span></span>
<span id="cb153-42"><a href="model-goodness-of-fit.html#cb153-42" tabindex="-1"></a><span class="do">## odegree8   13  28 39.73  53       0.00</span></span>
<span id="cb153-43"><a href="model-goodness-of-fit.html#cb153-43" tabindex="-1"></a><span class="do">## odegree9   16  17 27.48  45       0.00</span></span>
<span id="cb153-44"><a href="model-goodness-of-fit.html#cb153-44" tabindex="-1"></a><span class="do">## odegree10  20   7 15.74  26       0.22</span></span>
<span id="cb153-45"><a href="model-goodness-of-fit.html#cb153-45" tabindex="-1"></a><span class="do">## odegree11   8   2  9.25  16       0.86</span></span>
<span id="cb153-46"><a href="model-goodness-of-fit.html#cb153-46" tabindex="-1"></a><span class="do">## odegree12  11   1  4.98  12       0.04</span></span>
<span id="cb153-47"><a href="model-goodness-of-fit.html#cb153-47" tabindex="-1"></a><span class="do">## odegree13  13   0  2.12   7       0.00</span></span>
<span id="cb153-48"><a href="model-goodness-of-fit.html#cb153-48" tabindex="-1"></a><span class="do">## odegree14   6   0  0.72   3       0.00</span></span>
<span id="cb153-49"><a href="model-goodness-of-fit.html#cb153-49" tabindex="-1"></a><span class="do">## odegree15   6   0  0.41   3       0.00</span></span>
<span id="cb153-50"><a href="model-goodness-of-fit.html#cb153-50" tabindex="-1"></a><span class="do">## odegree16   7   0  0.17   2       0.00</span></span>
<span id="cb153-51"><a href="model-goodness-of-fit.html#cb153-51" tabindex="-1"></a><span class="do">## odegree17   4   0  0.03   1       0.00</span></span>
<span id="cb153-52"><a href="model-goodness-of-fit.html#cb153-52" tabindex="-1"></a><span class="do">## odegree18   3   0  0.01   1       0.00</span></span>
<span id="cb153-53"><a href="model-goodness-of-fit.html#cb153-53" tabindex="-1"></a><span class="do">## odegree19   0   0  0.02   1       1.00</span></span>
<span id="cb153-54"><a href="model-goodness-of-fit.html#cb153-54" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-55"><a href="model-goodness-of-fit.html#cb153-55" tabindex="-1"></a><span class="do">## Goodness-of-fit for edgewise shared partner </span></span>
<span id="cb153-56"><a href="model-goodness-of-fit.html#cb153-56" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-57"><a href="model-goodness-of-fit.html#cb153-57" tabindex="-1"></a><span class="do">##       obs  min    mean  max MC p-value</span></span>
<span id="cb153-58"><a href="model-goodness-of-fit.html#cb153-58" tabindex="-1"></a><span class="do">## esp0 1032 1991 2195.84 2289          0</span></span>
<span id="cb153-59"><a href="model-goodness-of-fit.html#cb153-59" tabindex="-1"></a><span class="do">## esp1  755  170  235.05  441          0</span></span>
<span id="cb153-60"><a href="model-goodness-of-fit.html#cb153-60" tabindex="-1"></a><span class="do">## esp2  352    1   14.86   86          0</span></span>
<span id="cb153-61"><a href="model-goodness-of-fit.html#cb153-61" tabindex="-1"></a><span class="do">## esp3  202    0    0.84   14          0</span></span>
<span id="cb153-62"><a href="model-goodness-of-fit.html#cb153-62" tabindex="-1"></a><span class="do">## esp4   79    0    0.08    2          0</span></span>
<span id="cb153-63"><a href="model-goodness-of-fit.html#cb153-63" tabindex="-1"></a><span class="do">## esp5   36    0    0.00    0          0</span></span>
<span id="cb153-64"><a href="model-goodness-of-fit.html#cb153-64" tabindex="-1"></a><span class="do">## esp6   14    0    0.00    0          0</span></span>
<span id="cb153-65"><a href="model-goodness-of-fit.html#cb153-65" tabindex="-1"></a><span class="do">## esp7    4    0    0.00    0          0</span></span>
<span id="cb153-66"><a href="model-goodness-of-fit.html#cb153-66" tabindex="-1"></a><span class="do">## esp8    1    0    0.00    0          0</span></span>
<span id="cb153-67"><a href="model-goodness-of-fit.html#cb153-67" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-68"><a href="model-goodness-of-fit.html#cb153-68" tabindex="-1"></a><span class="do">## Goodness-of-fit for minimum geodesic distance </span></span>
<span id="cb153-69"><a href="model-goodness-of-fit.html#cb153-69" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-70"><a href="model-goodness-of-fit.html#cb153-70" tabindex="-1"></a><span class="do">##       obs   min     mean   max MC p-value</span></span>
<span id="cb153-71"><a href="model-goodness-of-fit.html#cb153-71" tabindex="-1"></a><span class="do">## 1    2475  2319  2446.67  2571        0.6</span></span>
<span id="cb153-72"><a href="model-goodness-of-fit.html#cb153-72" tabindex="-1"></a><span class="do">## 2   10672 12048 13548.63 14726        0.0</span></span>
<span id="cb153-73"><a href="model-goodness-of-fit.html#cb153-73" tabindex="-1"></a><span class="do">## 3   31134 48016 54997.05 60096        0.0</span></span>
<span id="cb153-74"><a href="model-goodness-of-fit.html#cb153-74" tabindex="-1"></a><span class="do">## 4   50673 78122 80230.34 82613        0.0</span></span>
<span id="cb153-75"><a href="model-goodness-of-fit.html#cb153-75" tabindex="-1"></a><span class="do">## 5   42563 15553 20682.28 27611        0.0</span></span>
<span id="cb153-76"><a href="model-goodness-of-fit.html#cb153-76" tabindex="-1"></a><span class="do">## 6   18719   383  1227.29  2611        0.0</span></span>
<span id="cb153-77"><a href="model-goodness-of-fit.html#cb153-77" tabindex="-1"></a><span class="do">## 7    4808     0    40.46   214        0.0</span></span>
<span id="cb153-78"><a href="model-goodness-of-fit.html#cb153-78" tabindex="-1"></a><span class="do">## 8     822     0     0.87    16        0.0</span></span>
<span id="cb153-79"><a href="model-goodness-of-fit.html#cb153-79" tabindex="-1"></a><span class="do">## 9     100     0     0.00     0        0.0</span></span>
<span id="cb153-80"><a href="model-goodness-of-fit.html#cb153-80" tabindex="-1"></a><span class="do">## 10      7     0     0.00     0        0.0</span></span>
<span id="cb153-81"><a href="model-goodness-of-fit.html#cb153-81" tabindex="-1"></a><span class="do">## Inf 12333     0  1132.41  3324        0.0</span></span>
<span id="cb153-82"><a href="model-goodness-of-fit.html#cb153-82" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-83"><a href="model-goodness-of-fit.html#cb153-83" tabindex="-1"></a><span class="do">## Goodness-of-fit for model statistics </span></span>
<span id="cb153-84"><a href="model-goodness-of-fit.html#cb153-84" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-85"><a href="model-goodness-of-fit.html#cb153-85" tabindex="-1"></a><span class="do">##                     obs  min    mean  max MC p-value</span></span>
<span id="cb153-86"><a href="model-goodness-of-fit.html#cb153-86" tabindex="-1"></a><span class="do">## edges              2475 2319 2446.67 2571       0.60</span></span>
<span id="cb153-87"><a href="model-goodness-of-fit.html#cb153-87" tabindex="-1"></a><span class="do">## nodematch.hispanic 1832 1710 1807.58 1903       0.56</span></span>
<span id="cb153-88"><a href="model-goodness-of-fit.html#cb153-88" tabindex="-1"></a><span class="do">## nodematch.female1  1879 1760 1852.63 1970       0.60</span></span>
<span id="cb153-89"><a href="model-goodness-of-fit.html#cb153-89" tabindex="-1"></a><span class="do">## nodematch.eversmk1 1755 1614 1724.70 1824       0.56</span></span>
<span id="cb153-90"><a href="model-goodness-of-fit.html#cb153-90" tabindex="-1"></a><span class="do">## mutual              486  441  475.38  514       0.66</span></span>
<span id="cb153-91"><a href="model-goodness-of-fit.html#cb153-91" tabindex="-1"></a></span>
<span id="cb153-92"><a href="model-goodness-of-fit.html#cb153-92" tabindex="-1"></a><span class="co"># Plotting GOF statistics</span></span>
<span id="cb153-93"><a href="model-goodness-of-fit.html#cb153-93" tabindex="-1"></a><span class="fu">plot</span>(ans_gof)</span></code></pre></div>
<p><img src="part-01-04-ergms_files/figure-html/checking-gof-1.png" width="672" /><img src="part-01-04-ergms_files/figure-html/checking-gof-2.png" width="672" /><img src="part-01-04-ergms_files/figure-html/checking-gof-3.png" width="672" /><img src="part-01-04-ergms_files/figure-html/checking-gof-4.png" width="672" /><img src="part-01-04-ergms_files/figure-html/checking-gof-5.png" width="672" /></p>
<p>Try the following configuration instead</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="model-goodness-of-fit.html#cb154-1" tabindex="-1"></a>ans0_bis <span class="ot">&lt;-</span> <span class="fu">ergm</span>(</span>
<span id="cb154-2"><a href="model-goodness-of-fit.html#cb154-2" tabindex="-1"></a>  network_111 <span class="sc">~</span></span>
<span id="cb154-3"><a href="model-goodness-of-fit.html#cb154-3" tabindex="-1"></a>    edges <span class="sc">+</span></span>
<span id="cb154-4"><a href="model-goodness-of-fit.html#cb154-4" tabindex="-1"></a>    <span class="fu">nodematch</span>(<span class="st">&quot;hispanic&quot;</span>) <span class="sc">+</span></span>
<span id="cb154-5"><a href="model-goodness-of-fit.html#cb154-5" tabindex="-1"></a>    <span class="fu">nodematch</span>(<span class="st">&quot;female1&quot;</span>) <span class="sc">+</span></span>
<span id="cb154-6"><a href="model-goodness-of-fit.html#cb154-6" tabindex="-1"></a>    mutual <span class="sc">+</span> </span>
<span id="cb154-7"><a href="model-goodness-of-fit.html#cb154-7" tabindex="-1"></a>    <span class="fu">esp</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb154-8"><a href="model-goodness-of-fit.html#cb154-8" tabindex="-1"></a>    <span class="fu">idegree</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb154-9"><a href="model-goodness-of-fit.html#cb154-9" tabindex="-1"></a>    ,</span>
<span id="cb154-10"><a href="model-goodness-of-fit.html#cb154-10" tabindex="-1"></a>  <span class="at">constraints =</span> <span class="sc">~</span><span class="fu">bd</span>(<span class="at">maxout =</span> <span class="dv">19</span>),</span>
<span id="cb154-11"><a href="model-goodness-of-fit.html#cb154-11" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">control.ergm</span>(</span>
<span id="cb154-12"><a href="model-goodness-of-fit.html#cb154-12" tabindex="-1"></a>    <span class="at">seed        =</span> <span class="dv">1</span>,</span>
<span id="cb154-13"><a href="model-goodness-of-fit.html#cb154-13" tabindex="-1"></a>    <span class="at">MCMLE.maxit =</span> <span class="dv">15</span>,</span>
<span id="cb154-14"><a href="model-goodness-of-fit.html#cb154-14" tabindex="-1"></a>    <span class="at">parallel    =</span> <span class="dv">4</span>,</span>
<span id="cb154-15"><a href="model-goodness-of-fit.html#cb154-15" tabindex="-1"></a>    <span class="at">CD.maxit    =</span> <span class="dv">15</span>,</span>
<span id="cb154-16"><a href="model-goodness-of-fit.html#cb154-16" tabindex="-1"></a>    <span class="at">MCMC.samplesize =</span> <span class="dv">2048</span><span class="sc">*</span><span class="dv">4</span>,</span>
<span id="cb154-17"><a href="model-goodness-of-fit.html#cb154-17" tabindex="-1"></a>    <span class="at">MCMC.burnin =</span> <span class="dv">30000</span>,</span>
<span id="cb154-18"><a href="model-goodness-of-fit.html#cb154-18" tabindex="-1"></a>    <span class="at">MCMC.interval =</span> <span class="dv">2048</span><span class="sc">*</span><span class="dv">4</span></span>
<span id="cb154-19"><a href="model-goodness-of-fit.html#cb154-19" tabindex="-1"></a>    )</span>
<span id="cb154-20"><a href="model-goodness-of-fit.html#cb154-20" tabindex="-1"></a>  )</span></code></pre></div>
<p>Increase the sample size, so the curves are smoother, longer intervals (thinning), which reduces autocorrelation, and a larger burin. All this together to improve the Gelman test statistic. We also added idegree from 0 to 10, and esp from 0 to 3 to explicitly match those statistics in our model.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="model-goodness-of-fit.html#cb155-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;awful-chains.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:badconvergence"></span>
<img src="awful-chains.png" alt="An example of a terrible ERGM (no convergence at all). Also, a good example of why running multiple chains can be useful" width="357" />
<p class="caption">
Figure 6.1: An example of a terrible ERGM (no convergence at all). Also, a good example of why running multiple chains can be useful
</p>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-coda" class="csl-entry">
Plummer, Martyn, Nicky Best, Kate Cowles, and Karen Vines. 2006. <span>“<span>CODA</span>: Convergence Diagnosis and Output Analysis for MCMC.”</span> <em>R News</em> 6 (1): 7–11. <a href="https://journal.r-project.org/archive/">https://journal.r-project.org/archive/</a>.
</div>
<div id="ref-R-latticeExtra" class="csl-entry">
Sarkar, Deepayan, and Felix Andrews. 2016. <em>latticeExtra: Extra Graphical Utilities Based on Lattice</em>. <a href="https://CRAN.R-project.org/package=latticeExtra">https://CRAN.R-project.org/package=latticeExtra</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p>The statnet wiki website as a very nice example of (very) bad and good MCMC diagnostics plots <a href="https://statnet.org/trac/raw-attachment/wiki/Resources/ergm.fit.diagnostics.pdf">here</a>.<a href="model-goodness-of-fit.html#fnref9" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="running-ergms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="more-on-mcmc-convergence.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/gvegayon/appliedsnar/edit/master/part-01-04-ergms.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/gvegayon/appliedsnar/blob/master/part-01-04-ergms.Rmd",
"text": null
},
"download": ["appliedsnar.pdf", "appliedsnar.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
