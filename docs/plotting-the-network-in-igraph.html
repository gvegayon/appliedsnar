<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.4 Plotting the network in igraph | Applied Network Science with R</title>
  <meta name="description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="4.4 Plotting the network in igraph | Applied Network Science with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)" />
  <meta name="github-repo" content="gvegayon/appliedsnar" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.4 Plotting the network in igraph | Applied Network Science with R" />
  
  <meta name="twitter:description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)" />
  

<meta name="author" content="George G. Vega Yon" />


<meta name="date" content="2021-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="network-descriptive-stats.html"/>
<link rel="next" href="statistical-tests.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-40608305-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-40608305-4');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied SNA with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="the-book.html"><a href="the-book.html"><i class="fa fa-check"></i><b>1.1</b> The Book</a></li>
<li class="chapter" data-level="1.2" data-path="the-author.html"><a href="the-author.html"><i class="fa fa-check"></i><b>1.2</b> The author</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>3.1</b> What is R</a></li>
<li class="chapter" data-level="3.2" data-path="how-to-install-packages.html"><a href="how-to-install-packages.html"><i class="fa fa-check"></i><b>3.2</b> How to install packages</a></li>
<li class="chapter" data-level="3.3" data-path="prerequisits.html"><a href="prerequisits.html"><i class="fa fa-check"></i><b>3.3</b> Prerequisits</a></li>
<li class="chapter" data-level="3.4" data-path="a-gentle-quick-n-dirty-introduction-to-r.html"><a href="a-gentle-quick-n-dirty-introduction-to-r.html"><i class="fa fa-check"></i><b>3.4</b> A <del>gentle</del> Quick n’ Dirty Introduction to R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="network-nomination-data.html"><a href="network-nomination-data.html"><i class="fa fa-check"></i><b>4</b> Network Nomination Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html"><i class="fa fa-check"></i><b>4.1</b> Data preprocessing</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html#reading-the-data-into-r"><i class="fa fa-check"></i><b>4.1.1</b> Reading the data into R</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-preprocessing.html"><a href="data-preprocessing.html#creating-a-unique-id-for-each-participant"><i class="fa fa-check"></i><b>4.1.2</b> Creating a unique id for each participant</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="creating-a-network.html"><a href="creating-a-network.html"><i class="fa fa-check"></i><b>4.2</b> Creating a network</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="creating-a-network.html"><a href="creating-a-network.html#from-survey-to-edgelist"><i class="fa fa-check"></i><b>4.2.1</b> From survey to edgelist</a></li>
<li class="chapter" data-level="4.2.2" data-path="creating-a-network.html"><a href="creating-a-network.html#igraph-network"><i class="fa fa-check"></i><b>4.2.2</b> igraph network</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="network-descriptive-stats.html"><a href="network-descriptive-stats.html"><i class="fa fa-check"></i><b>4.3</b> Network descriptive stats</a></li>
<li class="chapter" data-level="4.4" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html"><i class="fa fa-check"></i><b>4.4</b> Plotting the network in igraph</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#single-plot"><i class="fa fa-check"></i><b>4.4.1</b> Single plot</a></li>
<li class="chapter" data-level="4.4.2" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#multiple-plots"><i class="fa fa-check"></i><b>4.4.2</b> Multiple plots</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>4.5</b> Statistical tests</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistical-tests.html"><a href="statistical-tests.html#is-nomination-number-correlated-with-indegree"><i class="fa fa-check"></i><b>4.5.1</b> Is nomination number correlated with indegree?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exponential-random-graph-models.html"><a href="exponential-random-graph-models.html"><i class="fa fa-check"></i><b>5</b> Exponential Random Graph Models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="a-naïve-example.html"><a href="a-naïve-example.html"><i class="fa fa-check"></i><b>5.1</b> A naïve example</a></li>
<li class="chapter" data-level="5.2" data-path="estimation-of-ergms.html"><a href="estimation-of-ergms.html"><i class="fa fa-check"></i><b>5.2</b> Estimation of ERGMs</a></li>
<li class="chapter" data-level="5.3" data-path="the-ergm-package.html"><a href="the-ergm-package.html"><i class="fa fa-check"></i><b>5.3</b> The <code>ergm</code> package</a></li>
<li class="chapter" data-level="5.4" data-path="running-ergms.html"><a href="running-ergms.html"><i class="fa fa-check"></i><b>5.4</b> Running ERGMs</a></li>
<li class="chapter" data-level="5.5" data-path="model-goodness-of-fit.html"><a href="model-goodness-of-fit.html"><i class="fa fa-check"></i><b>5.5</b> Model Goodness-of-Fit</a></li>
<li class="chapter" data-level="5.6" data-path="more-on-mcmc-convergence.html"><a href="more-on-mcmc-convergence.html"><i class="fa fa-check"></i><b>5.6</b> More on MCMC convergence</a></li>
<li class="chapter" data-level="5.7" data-path="mathematical-interpretation.html"><a href="mathematical-interpretation.html"><i class="fa fa-check"></i><b>5.7</b> Mathematical Interpretation</a></li>
<li class="chapter" data-level="5.8" data-path="markov-independence.html"><a href="markov-independence.html"><i class="fa fa-check"></i><b>5.8</b> Markov independence</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="separable-temporal-exponential-family-random-graph-models.html"><a href="separable-temporal-exponential-family-random-graph-models.html"><i class="fa fa-check"></i><b>6</b> (Separable) Temporal Exponential Family Random Graph Models</a></li>
<li class="chapter" data-level="7" data-path="stochastic-actor-oriented-models.html"><a href="stochastic-actor-oriented-models.html"><i class="fa fa-check"></i><b>7</b> Stochastic Actor Oriented Models</a></li>
<li class="chapter" data-level="8" data-path="hypothesis-testing-in-networks.html"><a href="hypothesis-testing-in-networks.html"><i class="fa fa-check"></i><b>8</b> Hypothesis testing in networks</a>
<ul>
<li class="chapter" data-level="8.1" data-path="comparing-networks.html"><a href="comparing-networks.html"><i class="fa fa-check"></i><b>8.1</b> Comparing networks</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="comparing-networks.html"><a href="comparing-networks.html#network-bootstrap"><i class="fa fa-check"></i><b>8.1.1</b> Network bootstrap</a></li>
<li class="chapter" data-level="8.1.2" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-normal"><i class="fa fa-check"></i><b>8.1.2</b> When the statistic is normal</a></li>
<li class="chapter" data-level="8.1.3" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-not-normal"><i class="fa fa-check"></i><b>8.1.3</b> When the statistic is NOT normal</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>8.2</b> Examples</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="examples.html"><a href="examples.html#average-of-node-level-stats"><i class="fa fa-check"></i><b>8.2.1</b> Average of node-level stats</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>A</b> Datasets</a>
<ul>
<li class="chapter" data-level="A.1" data-path="sns-data.html"><a href="sns-data.html"><i class="fa fa-check"></i><b>A.1</b> SNS data</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="sns-data.html"><a href="sns-data.html#about-the-data"><i class="fa fa-check"></i><b>A.1.1</b> About the data</a></li>
<li class="chapter" data-level="A.1.2" data-path="sns-data.html"><a href="sns-data.html#variables"><i class="fa fa-check"></i><b>A.1.2</b> Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Network Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-the-network-in-igraph" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Plotting the network in igraph</h2>
<div id="single-plot" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Single plot</h3>
<p>Let’s take a look at how does our network looks like when we use the default parameters in the plot method of the igraph object:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="plotting-the-network-in-igraph.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ig_year1)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:03-plot-raw"></span>
<img src="03-week-1-sns-study_files/figure-html/03-plot-raw-1.png" alt="A not very nice network plot. This is what we get with the default parameters in igraph." width="672" />
<p class="caption">
Figure 4.1: A not very nice network plot. This is what we get with the default parameters in igraph.
</p>
</div>
<p>Not very nice, right? A couple of things with this plot:</p>
<ol style="list-style-type: decimal">
<li><p>We are looking at all schools simultaneously, which does not make sense. So, instead of plotting <code>ig_year1</code>, we will focus on <code>ig_year1_111</code>.</p></li>
<li><p>All the vertices have the same size, and more over, are overalaping. So, instead of using the default size, we will size the vertices by indegree using the <code>degree</code> function, and passing the vector of degrees to <code>vertex.size</code>.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p></li>
<li><p>Given the number of vertices in these networks, the labels are not useful here. So we will remove them by setting <code>vertex.label = NA</code>. Moreover, we will reduce the size of the arrows’ tip by setting <code>edge.arrow.size = 0.25</code>.</p></li>
<li><p>And finally, we will set the color of each vertex to be a function of whether the individual is hispanic or not. For this last bit we need to go a bit more of programming:</p></li>
</ol>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="plotting-the-network-in-igraph.html#cb113-1" aria-hidden="true" tabindex="-1"></a>col_hispanic <span class="ot">&lt;-</span> <span class="fu">V</span>(ig_year1_111)<span class="sc">$</span>hispanic <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb113-2"><a href="plotting-the-network-in-igraph.html#cb113-2" aria-hidden="true" tabindex="-1"></a>col_hispanic <span class="ot">&lt;-</span> <span class="fu">coalesce</span>(col_hispanic, <span class="dv">3</span>) </span>
<span id="cb113-3"><a href="plotting-the-network-in-igraph.html#cb113-3" aria-hidden="true" tabindex="-1"></a>col_hispanic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;white&quot;</span>)[col_hispanic]</span></code></pre></div>
<p>Line by line, we did the following:</p>
<ol style="list-style-type: decimal">
<li><p>The first line added one to all no <code>NA</code> values, so that the 0s (non-hispanic) turned to 1s and the 1s (hispanic) turned to 2s.</p></li>
<li><p>The second line replaced all <code>NA</code>s with the number 3, so that our vector <code>col_hispanic</code> now ranges from 1 to 3 with no <code>NA</code>s in it.</p></li>
<li><p>In the last line we created a vector of colors. Essentially, what we are doing here is telling R to create a vector of length <code>length(col_hispanic)</code> by selecting elements by index from the vector <code>c("steelblue", "tomato", "white")</code>. This way, if, for example, the first element of the vector <code>col_hispanic</code> was a 3, our new vector of colors would have a <code>"white"</code> in it.</p></li>
</ol>
<p>To make sure we know we are right, let’s print the first 10 elements of our new vector of colors together with the original <code>hispanic</code> column:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="plotting-the-network-in-igraph.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb114-2"><a href="plotting-the-network-in-igraph.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">original =</span> <span class="fu">V</span>(ig_year1_111)<span class="sc">$</span>hispanic[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb114-3"><a href="plotting-the-network-in-igraph.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors   =</span> col_hispanic[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb114-4"><a href="plotting-the-network-in-igraph.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>##       original colors     
##  [1,] &quot;1&quot;      &quot;tomato&quot;   
##  [2,] &quot;1&quot;      &quot;tomato&quot;   
##  [3,] &quot;0&quot;      &quot;steelblue&quot;
##  [4,] &quot;1&quot;      &quot;tomato&quot;   
##  [5,] &quot;1&quot;      &quot;tomato&quot;   
##  [6,] &quot;1&quot;      &quot;tomato&quot;   
##  [7,] &quot;1&quot;      &quot;tomato&quot;   
##  [8,] &quot;1&quot;      &quot;tomato&quot;   
##  [9,] &quot;0&quot;      &quot;steelblue&quot;
## [10,] &quot;1&quot;      &quot;tomato&quot;</code></pre>
<p>With our nice vector of colors, now we can pass it to <code>plot.igraph</code> (which we call implicitly by just calling <code>plot</code>), via the <code>vertex.color</code> argument:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="plotting-the-network-in-igraph.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fancy graph</span></span>
<span id="cb116-2"><a href="plotting-the-network-in-igraph.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb116-3"><a href="plotting-the-network-in-igraph.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb116-4"><a href="plotting-the-network-in-igraph.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  ig_year1_111,</span>
<span id="cb116-5"><a href="plotting-the-network-in-igraph.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.size     =</span> <span class="fu">degree</span>(ig_year1_111)<span class="sc">/</span><span class="dv">10</span> <span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb116-6"><a href="plotting-the-network-in-igraph.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.label    =</span> <span class="cn">NA</span>,</span>
<span id="cb116-7"><a href="plotting-the-network-in-igraph.html#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">edge.arrow.size =</span> .<span class="dv">25</span>,</span>
<span id="cb116-8"><a href="plotting-the-network-in-igraph.html#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.color    =</span> col_hispanic</span>
<span id="cb116-9"><a href="plotting-the-network-in-igraph.html#cb116-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure"><span id="fig:03-plot-neat1"></span>
<img src="03-week-1-sns-study_files/figure-html/03-plot-neat1-1.png" alt="Friends network in time 1 for school 111. " width="672" />
<p class="caption">
Figure 4.2: Friends network in time 1 for school 111.
</p>
</div>
<p>Nice! So it does look better. The only problem is that we have a lot of isolates. Let’s try again by drawing the same plot without isolates. To do so we need to filter the graph, for which we will use the function <code>induced_subgraph</code></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="plotting-the-network-in-igraph.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Which vertices are not isolates?</span></span>
<span id="cb117-2"><a href="plotting-the-network-in-igraph.html#cb117-2" aria-hidden="true" tabindex="-1"></a>which_ids <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">degree</span>(ig_year1_111, <span class="at">mode =</span> <span class="st">&quot;total&quot;</span>) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb117-3"><a href="plotting-the-network-in-igraph.html#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="plotting-the-network-in-igraph.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the subgraph</span></span>
<span id="cb117-5"><a href="plotting-the-network-in-igraph.html#cb117-5" aria-hidden="true" tabindex="-1"></a>ig_year1_111_sub <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(ig_year1_111, which_ids)</span>
<span id="cb117-6"><a href="plotting-the-network-in-igraph.html#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="plotting-the-network-in-igraph.html#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to get the same subset in col_hispanic</span></span>
<span id="cb117-8"><a href="plotting-the-network-in-igraph.html#cb117-8" aria-hidden="true" tabindex="-1"></a>col_hispanic <span class="ot">&lt;-</span> col_hispanic[which_ids]</span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="plotting-the-network-in-igraph.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fancy graph</span></span>
<span id="cb118-2"><a href="plotting-the-network-in-igraph.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb118-3"><a href="plotting-the-network-in-igraph.html#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb118-4"><a href="plotting-the-network-in-igraph.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  ig_year1_111_sub,</span>
<span id="cb118-5"><a href="plotting-the-network-in-igraph.html#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.size     =</span> <span class="fu">degree</span>(ig_year1_111_sub)<span class="sc">/</span><span class="dv">5</span> <span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb118-6"><a href="plotting-the-network-in-igraph.html#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.label    =</span> <span class="cn">NA</span>,</span>
<span id="cb118-7"><a href="plotting-the-network-in-igraph.html#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">edge.arrow.size =</span> .<span class="dv">25</span>,</span>
<span id="cb118-8"><a href="plotting-the-network-in-igraph.html#cb118-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.color    =</span> col_hispanic</span>
<span id="cb118-9"><a href="plotting-the-network-in-igraph.html#cb118-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure"><span id="fig:03-plot-neat2"></span>
<img src="03-week-1-sns-study_files/figure-html/03-plot-neat2-1.png" alt="Friends network in time 1 for school 111. The graph excludes isolates." width="672" />
<p class="caption">
Figure 4.3: Friends network in time 1 for school 111. The graph excludes isolates.
</p>
</div>
<p>Now that’s better! An interesting pattern that shows up is that individuals seem to cluster by whether they are hispanic or not.</p>
<p>We can actually write this as a function so that, instead of us copying and pasting the code <span class="math inline">\(n\)</span> times (supposing that we want to crate a plot similar to this <span class="math inline">\(n\)</span> times). The next subsection does that.</p>
</div>
<div id="multiple-plots" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Multiple plots</h3>
<p>When you are repeating yourself over and over again, it is a good idea to write down a sequence of commands as a function. In this case, since we will be running the same type of plot for all schools/waves, we write a function in which the only things that changes are: (a) the school id, and (b) the color of the nodes.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="plotting-the-network-in-igraph.html#cb119-1" aria-hidden="true" tabindex="-1"></a>myplot <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb119-2"><a href="plotting-the-network-in-igraph.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  net,</span>
<span id="cb119-3"><a href="plotting-the-network-in-igraph.html#cb119-3" aria-hidden="true" tabindex="-1"></a>  schoolid,</span>
<span id="cb119-4"><a href="plotting-the-network-in-igraph.html#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mindgr =</span> <span class="dv">1</span>,</span>
<span id="cb119-5"><a href="plotting-the-network-in-igraph.html#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vcol   =</span> <span class="st">&quot;tomato&quot;</span>,</span>
<span id="cb119-6"><a href="plotting-the-network-in-igraph.html#cb119-6" aria-hidden="true" tabindex="-1"></a>  ...) {</span>
<span id="cb119-7"><a href="plotting-the-network-in-igraph.html#cb119-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-8"><a href="plotting-the-network-in-igraph.html#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creating a subgraph</span></span>
<span id="cb119-9"><a href="plotting-the-network-in-igraph.html#cb119-9" aria-hidden="true" tabindex="-1"></a>  subnet <span class="ot">&lt;-</span> <span class="fu">induced_subgraph</span>(</span>
<span id="cb119-10"><a href="plotting-the-network-in-igraph.html#cb119-10" aria-hidden="true" tabindex="-1"></a>    net,</span>
<span id="cb119-11"><a href="plotting-the-network-in-igraph.html#cb119-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">which</span>(<span class="fu">degree</span>(net, <span class="at">mode =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">&gt;=</span> mindgr <span class="sc">&amp;</span> <span class="fu">V</span>(net)<span class="sc">$</span>school <span class="sc">==</span> schoolid)</span>
<span id="cb119-12"><a href="plotting-the-network-in-igraph.html#cb119-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb119-13"><a href="plotting-the-network-in-igraph.html#cb119-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-14"><a href="plotting-the-network-in-igraph.html#cb119-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fancy graph</span></span>
<span id="cb119-15"><a href="plotting-the-network-in-igraph.html#cb119-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb119-16"><a href="plotting-the-network-in-igraph.html#cb119-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(</span>
<span id="cb119-17"><a href="plotting-the-network-in-igraph.html#cb119-17" aria-hidden="true" tabindex="-1"></a>    subnet,</span>
<span id="cb119-18"><a href="plotting-the-network-in-igraph.html#cb119-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.size     =</span> <span class="fu">degree</span>(subnet)<span class="sc">/</span><span class="dv">5</span>,</span>
<span id="cb119-19"><a href="plotting-the-network-in-igraph.html#cb119-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.label    =</span> <span class="cn">NA</span>,</span>
<span id="cb119-20"><a href="plotting-the-network-in-igraph.html#cb119-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.arrow.size =</span> .<span class="dv">25</span>,</span>
<span id="cb119-21"><a href="plotting-the-network-in-igraph.html#cb119-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">vertex.color    =</span> vcol,</span>
<span id="cb119-22"><a href="plotting-the-network-in-igraph.html#cb119-22" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb119-23"><a href="plotting-the-network-in-igraph.html#cb119-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb119-24"><a href="plotting-the-network-in-igraph.html#cb119-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The function definition:</p>
<ol style="list-style-type: decimal">
<li><p>The <code>myplot &lt;- function([arguments]) {[body of the function]}</code> tells R that we are going to create a function called <code>myplot</code>.</p></li>
<li><p>In the arguments part, we are declaring 4 specific arguments: <code>net</code>, <code>schoolid</code>, <code>mindgr</code>, and <code>vcol</code>. These are an igraph object, the school id, the minimum degree that a vertex must have to be included in the plot, and the color of the vertices. Notice that, as a difference from other programming languages, in R we don’t need to declare the types that these objects are.</p></li>
<li><p>The elipsis object, <code>...</code>, is a special object in R that allows us passing other arguments without us specifying which. In our case, if you take a look at the <code>plot</code> bit of the body of the function, you will see that we also added <code>...</code>; this means that whatever other arguments (different from the ones that we explicitly defined) are passed to the function, these will be passed to the function <code>plot</code>, moreover, to the <code>plot.gexf</code> function (since the <code>subnet</code> object is actually an igraph object). In practice, this implies that we can, for example, set the argument <code>edge.arrow.size</code> when calling <code>myplot</code>, even though we did not included it in the function definition! (See <code>?dotsMethods</code> in R for more details).</p></li>
</ol>
<p>In the following lines of code, using our new function, we will plot each schools’ network in the same plotting device (window) with the help of the <code>par</code> function, and add legend with the <code>legend</code>:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="plotting-the-network-in-igraph.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting all together</span></span>
<span id="cb120-2"><a href="plotting-the-network-in-igraph.html#cb120-2" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb120-3"><a href="plotting-the-network-in-igraph.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">mai =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">oma=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb120-4"><a href="plotting-the-network-in-igraph.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">myplot</span>(ig_year1, <span class="dv">111</span>, <span class="at">vcol =</span> <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb120-5"><a href="plotting-the-network-in-igraph.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">myplot</span>(ig_year1, <span class="dv">112</span>, <span class="at">vcol =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb120-6"><a href="plotting-the-network-in-igraph.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">myplot</span>(ig_year1, <span class="dv">113</span>, <span class="at">vcol =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb120-7"><a href="plotting-the-network-in-igraph.html#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="fu">myplot</span>(ig_year1, <span class="dv">114</span>, <span class="at">vcol =</span> <span class="st">&quot;gold&quot;</span>)</span>
<span id="cb120-8"><a href="plotting-the-network-in-igraph.html#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="fu">myplot</span>(ig_year1, <span class="dv">115</span>, <span class="at">vcol =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb120-9"><a href="plotting-the-network-in-igraph.html#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar)</span>
<span id="cb120-10"><a href="plotting-the-network-in-igraph.html#cb120-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-11"><a href="plotting-the-network-in-igraph.html#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A fancy legend</span></span>
<span id="cb120-12"><a href="plotting-the-network-in-igraph.html#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb120-13"><a href="plotting-the-network-in-igraph.html#cb120-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;bottomright&quot;</span>,</span>
<span id="cb120-14"><a href="plotting-the-network-in-igraph.html#cb120-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="dv">111</span>, <span class="dv">112</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>),</span>
<span id="cb120-15"><a href="plotting-the-network-in-igraph.html#cb120-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">pt.bg  =</span> <span class="fu">c</span>(<span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;gold&quot;</span>, <span class="st">&quot;white&quot;</span>),</span>
<span id="cb120-16"><a href="plotting-the-network-in-igraph.html#cb120-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch    =</span> <span class="dv">21</span>,</span>
<span id="cb120-17"><a href="plotting-the-network-in-igraph.html#cb120-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex    =</span> <span class="dv">1</span>,</span>
<span id="cb120-18"><a href="plotting-the-network-in-igraph.html#cb120-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty    =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb120-19"><a href="plotting-the-network-in-igraph.html#cb120-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">title  =</span> <span class="st">&quot;School&quot;</span></span>
<span id="cb120-20"><a href="plotting-the-network-in-igraph.html#cb120-20" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure"><span id="fig:03-myplot-call"></span>
<img src="03-week-1-sns-study_files/figure-html/03-myplot-call-1.png" alt="All 5 schools in time 1. Again, the graphs exclude isolates." width="672" />
<p class="caption">
Figure 4.4: All 5 schools in time 1. Again, the graphs exclude isolates.
</p>
</div>
<p>So what happend here?</p>
<ul>
<li><p><code>oldpar &lt;- par(no.readonly = TRUE)</code> This line stores the current parameters for plotting. Since we are going to be changing them, we better make sure we are able to go back!.</p></li>
<li><p><code>par(mfrow = c(2, 3), mai = rep(0, 4), oma=rep(0, 4))</code> Here we are setting various things at the same time. <code>mfrow</code> specifies how many <em>figures</em> will be drawn and in what order, in particular, we are asking the plotting device to allow for 2*3 = 6 plots organized in 2 rows and 3 columns, and these will be drawn by row.</p>
<p><code>mai</code> specifies the size of the margins in inches. Setting all margins equal to zero (which is what we are doing now) gives more space to the network itself. The same is true for <code>oma</code>. See <code>?par</code> for more info.</p></li>
<li><p><code>myplot(ig_year1, ...)</code> This is simply calling our plotting function. The neat part of this is that, since we set <code>mfrow = c(2, 3)</code>, R takes care of <em>distributing</em> the plots in the device.</p></li>
<li><p><code>par(oldpar)</code> This line allows us to restore the plotting parameters.</p></li>
</ul>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>Figuring out what is the optimal vertex size is a bit tricky. Without getting too technical, there’s no other way of getting <em>nice</em> vertex size other than just playing with different values of it. A nice solution to this is using <a href="https://www.rdocumentation.org/packages/netdiffuseR/versions/1.17.0/topics/rescale_vertex_igraph"><code>netdiffuseR::igraph_vertex_rescale</code></a> which rescales the vertices so that these keep their aspect ratio to a predefined proportion of the screen.<a href="plotting-the-network-in-igraph.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="network-descriptive-stats.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-tests.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/gvegayon/appliedsnar/edit/master/03-week-1-sns-study.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/gvegayon/appliedsnar/blob/master/03-week-1-sns-study.Rmd",
"text": null
},
"download": ["appliedsnar.pdf", "appliedsnar.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
