<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.2 Example 2: Bi-partite networks | Applied Network Science with R</title>
  <meta name="description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="6.2 Example 2: Bi-partite networks | Applied Network Science with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)" />
  <meta name="github-repo" content="gvegayon/appliedsnar" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.2 Example 2: Bi-partite networks | Applied Network Science with R" />
  
  <meta name="twitter:description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)" />
  

<meta name="author" content="George G. Vega Yon" />


<meta name="date" content="2022-04-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="example-1-interlocking-egos-and-disconnected-alters.html"/>
<link rel="next" href="separable-temporal-exponential-family-random-graph-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-40608305-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-40608305-4');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied SNA with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About<span></span></a><ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#the-book"><i class="fa fa-check"></i><b>1.0.1</b> The Book<span></span></a></li>
<li class="chapter" data-level="1.0.2" data-path="index.html"><a href="index.html#the-author"><i class="fa fa-check"></i><b>1.0.2</b> The author<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction<span></span></a></li>
<li class="chapter" data-level="3" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>3</b> R Basics<span></span></a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>3.1</b> What is R<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="how-to-install-packages.html"><a href="how-to-install-packages.html"><i class="fa fa-check"></i><b>3.2</b> How to install packages<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="prerequisits.html"><a href="prerequisits.html"><i class="fa fa-check"></i><b>3.3</b> Prerequisits<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="a-gentle-quick-n-dirty-introduction-to-r.html"><a href="a-gentle-quick-n-dirty-introduction-to-r.html"><i class="fa fa-check"></i><b>3.4</b> A <del>gentle</del> Quick n’ Dirty Introduction to R<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="network-nomination-data.html"><a href="network-nomination-data.html"><i class="fa fa-check"></i><b>4</b> Network Nomination Data<span></span></a><ul>
<li class="chapter" data-level="4.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html"><i class="fa fa-check"></i><b>4.1</b> Data preprocessing<span></span></a><ul>
<li class="chapter" data-level="4.1.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html#reading-the-data-into-r"><i class="fa fa-check"></i><b>4.1.1</b> Reading the data into R<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="data-preprocessing.html"><a href="data-preprocessing.html#creating-a-unique-id-for-each-participant"><i class="fa fa-check"></i><b>4.1.2</b> Creating a unique id for each participant<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="creating-a-network.html"><a href="creating-a-network.html"><i class="fa fa-check"></i><b>4.2</b> Creating a network<span></span></a><ul>
<li class="chapter" data-level="4.2.1" data-path="creating-a-network.html"><a href="creating-a-network.html#from-survey-to-edgelist"><i class="fa fa-check"></i><b>4.2.1</b> From survey to edgelist<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="creating-a-network.html"><a href="creating-a-network.html#igraph-network"><i class="fa fa-check"></i><b>4.2.2</b> igraph network<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="network-descriptive-stats.html"><a href="network-descriptive-stats.html"><i class="fa fa-check"></i><b>4.3</b> Network descriptive stats<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html"><i class="fa fa-check"></i><b>4.4</b> Plotting the network in igraph<span></span></a><ul>
<li class="chapter" data-level="4.4.1" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#single-plot"><i class="fa fa-check"></i><b>4.4.1</b> Single plot<span></span></a></li>
<li class="chapter" data-level="4.4.2" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#multiple-plots"><i class="fa fa-check"></i><b>4.4.2</b> Multiple plots<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>4.5</b> Statistical tests<span></span></a><ul>
<li class="chapter" data-level="4.5.1" data-path="statistical-tests.html"><a href="statistical-tests.html#is-nomination-number-correlated-with-indegree"><i class="fa fa-check"></i><b>4.5.1</b> Is nomination number correlated with indegree?<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exponential-random-graph-models.html"><a href="exponential-random-graph-models.html"><i class="fa fa-check"></i><b>5</b> Exponential Random Graph Models<span></span></a><ul>
<li class="chapter" data-level="5.1" data-path="a-naïve-example.html"><a href="a-naïve-example.html"><i class="fa fa-check"></i><b>5.1</b> A naïve example<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="estimation-of-ergms.html"><a href="estimation-of-ergms.html"><i class="fa fa-check"></i><b>5.2</b> Estimation of ERGMs<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="the-ergm-package.html"><a href="the-ergm-package.html"><i class="fa fa-check"></i><b>5.3</b> The <code>ergm</code> package<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="running-ergms.html"><a href="running-ergms.html"><i class="fa fa-check"></i><b>5.4</b> Running ERGMs<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="model-goodness-of-fit.html"><a href="model-goodness-of-fit.html"><i class="fa fa-check"></i><b>5.5</b> Model Goodness-of-Fit<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="more-on-mcmc-convergence.html"><a href="more-on-mcmc-convergence.html"><i class="fa fa-check"></i><b>5.6</b> More on MCMC convergence<span></span></a></li>
<li class="chapter" data-level="5.7" data-path="mathematical-interpretation.html"><a href="mathematical-interpretation.html"><i class="fa fa-check"></i><b>5.7</b> Mathematical Interpretation<span></span></a></li>
<li class="chapter" data-level="5.8" data-path="markov-independence.html"><a href="markov-independence.html"><i class="fa fa-check"></i><b>5.8</b> Markov independence<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-constraints-in-ergms.html"><a href="using-constraints-in-ergms.html"><i class="fa fa-check"></i><b>6</b> Using constraints in ERGMs<span></span></a><ul>
<li class="chapter" data-level="6.1" data-path="example-1-interlocking-egos-and-disconnected-alters.html"><a href="example-1-interlocking-egos-and-disconnected-alters.html"><i class="fa fa-check"></i><b>6.1</b> Example 1: Interlocking egos and disconnected alters<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="example-2-bi-partite-networks.html"><a href="example-2-bi-partite-networks.html"><i class="fa fa-check"></i><b>6.2</b> Example 2: Bi-partite networks<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="separable-temporal-exponential-family-random-graph-models.html"><a href="separable-temporal-exponential-family-random-graph-models.html"><i class="fa fa-check"></i><b>7</b> (Separable) Temporal Exponential Family Random Graph Models<span></span></a></li>
<li class="chapter" data-level="8" data-path="hypothesis-testing-in-networks.html"><a href="hypothesis-testing-in-networks.html"><i class="fa fa-check"></i><b>8</b> Hypothesis testing in networks<span></span></a><ul>
<li class="chapter" data-level="8.1" data-path="comparing-networks.html"><a href="comparing-networks.html"><i class="fa fa-check"></i><b>8.1</b> Comparing networks<span></span></a><ul>
<li class="chapter" data-level="8.1.1" data-path="comparing-networks.html"><a href="comparing-networks.html#network-bootstrap"><i class="fa fa-check"></i><b>8.1.1</b> Network bootstrap<span></span></a></li>
<li class="chapter" data-level="8.1.2" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-normal"><i class="fa fa-check"></i><b>8.1.2</b> When the statistic is normal<span></span></a></li>
<li class="chapter" data-level="8.1.3" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-not-normal"><i class="fa fa-check"></i><b>8.1.3</b> When the statistic is NOT normal<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>8.2</b> Examples<span></span></a><ul>
<li class="chapter" data-level="8.2.1" data-path="examples.html"><a href="examples.html#average-of-node-level-stats"><i class="fa fa-check"></i><b>8.2.1</b> Average of node-level stats<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="network-diffussion-with-netdiffuser.html"><a href="network-diffussion-with-netdiffuser.html"><i class="fa fa-check"></i><b>9</b> Network diffussion with <code>netdiffuseR</code><span></span></a><ul>
<li class="chapter" data-level="9.1" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html"><i class="fa fa-check"></i><b>9.1</b> Network diffusion of innovation<span></span></a><ul>
<li class="chapter" data-level="9.1.1" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html#diffusion-networks"><i class="fa fa-check"></i><b>9.1.1</b> Diffusion networks<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html#thresholds"><i class="fa fa-check"></i><b>9.1.2</b> Thresholds<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html"><i class="fa fa-check"></i><b>9.2</b> The netdiffuseR R package<span></span></a><ul>
<li class="chapter" data-level="9.2.1" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#overview"><i class="fa fa-check"></i><b>9.2.1</b> Overview<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#datasets"><i class="fa fa-check"></i><b>9.2.2</b> Datasets<span></span></a></li>
<li class="chapter" data-level="9.2.3" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#visualization-methods"><i class="fa fa-check"></i><b>9.2.3</b> Visualization methods<span></span></a></li>
<li class="chapter" data-level="9.2.4" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#problems"><i class="fa fa-check"></i><b>9.2.4</b> Problems<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html"><i class="fa fa-check"></i><b>9.3</b> Simulation of diffusion processes<span></span></a><ul>
<li class="chapter" data-level="9.3.1" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#simulating-diffusion-networks"><i class="fa fa-check"></i><b>9.3.1</b> Simulating diffusion networks<span></span></a></li>
<li class="chapter" data-level="9.3.2" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#rumor-spreading"><i class="fa fa-check"></i><b>9.3.2</b> Rumor spreading<span></span></a></li>
<li class="chapter" data-level="9.3.3" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#difussion"><i class="fa fa-check"></i><b>9.3.3</b> Difussion<span></span></a></li>
<li class="chapter" data-level="9.3.4" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#mentor-matching"><i class="fa fa-check"></i><b>9.3.4</b> Mentor Matching<span></span></a></li>
<li class="chapter" data-level="9.3.5" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#example-by-changing-threshold"><i class="fa fa-check"></i><b>9.3.5</b> Example by changing threshold<span></span></a></li>
<li class="chapter" data-level="9.3.6" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#problems-1"><i class="fa fa-check"></i><b>9.3.6</b> Problems<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>9.4</b> Statistical inference<span></span></a><ul>
<li class="chapter" data-level="9.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#morans-i"><i class="fa fa-check"></i><b>9.4.1</b> Moran’s I<span></span></a></li>
<li class="chapter" data-level="9.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#using-geodesics"><i class="fa fa-check"></i><b>9.4.2</b> Using geodesics<span></span></a></li>
<li class="chapter" data-level="9.4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#structural-dependence-and-permutation-tests"><i class="fa fa-check"></i><b>9.4.3</b> Structural dependence and permutation tests<span></span></a></li>
<li class="chapter" data-level="9.4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#idea"><i class="fa fa-check"></i><b>9.4.4</b> Idea<span></span></a></li>
<li class="chapter" data-level="9.4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#regression-analysis"><i class="fa fa-check"></i><b>9.4.5</b> Regression analysis<span></span></a></li>
<li class="chapter" data-level="9.4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#problems-2"><i class="fa fa-check"></i><b>9.4.6</b> Problems<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stochastic-actor-oriented-models.html"><a href="stochastic-actor-oriented-models.html"><i class="fa fa-check"></i><b>10</b> Stochastic Actor Oriented Models<span></span></a></li>
<li class="appendix"><span><b>Appendix<span></span></b></span></li>
<li class="chapter" data-level="A" data-path="datasets-1.html"><a href="datasets-1.html"><i class="fa fa-check"></i><b>A</b> Datasets<span></span></a><ul>
<li class="chapter" data-level="A.1" data-path="sns-data.html"><a href="sns-data.html"><i class="fa fa-check"></i><b>A.1</b> SNS data<span></span></a><ul>
<li class="chapter" data-level="A.1.1" data-path="sns-data.html"><a href="sns-data.html#about-the-data"><i class="fa fa-check"></i><b>A.1.1</b> About the data<span></span></a></li>
<li class="chapter" data-level="A.1.2" data-path="sns-data.html"><a href="sns-data.html#variables"><i class="fa fa-check"></i><b>A.1.2</b> Variables<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Network Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-2-bi-partite-networks" class="section level2 hasAnchor">
<h2><span class="header-section-number">6.2</span> Example 2: Bi-partite networks<a href="example-2-bi-partite-networks.html#example-2-bi-partite-networks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the case of bipartite networks (sometimes called affiliation networks,) we can
use <code>ergm</code>’s terms for bipartite graphs to corroborate what we discussed
here. For example, the two-star term. Let’s start simulating a bipartite
network using the <code>edges</code> and <code>two-star</code> parameters. Since the <code>k-star</code> term
is usually complex to fit (tends to generate degenerate models,) we will
take advantage of the <code>Log()</code> transformation function in the <code>ergm</code> package
to smooth the term.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
<p>The bipartite network that we will be simulating will have 100 actors and
50 entities. Actors, which we will map to the first level of the <code>ergm</code> terms,
this is, <code>b1star</code> <code>b1nodematch</code>, etc. will send ties to the entities,
the second level of the bipartite ERGM. To create a bipartite network, we will
create an empty matrix of size <code>nactors x nentitites</code>; thus, actors are
represented by rows and entities by columns.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1"><span class="co"># Parameters for the simulation</span></a>
<a class="sourceLine" id="cb216-2" title="2">nactors   &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb216-3" title="3">nentities &lt;-<span class="st"> </span><span class="kw">floor</span>(nactors<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb216-4" title="4">n         &lt;-<span class="st"> </span>nactors <span class="op">+</span><span class="st"> </span>nentities</a>
<a class="sourceLine" id="cb216-5" title="5"></a>
<a class="sourceLine" id="cb216-6" title="6"><span class="co"># Creating an empty bipartite network (baseline)</span></a>
<a class="sourceLine" id="cb216-7" title="7">net_b &lt;-<span class="st"> </span><span class="kw">network</span>(</a>
<a class="sourceLine" id="cb216-8" title="8">  <span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> nactors, <span class="dt">ncol =</span> nentities), <span class="dt">bipartite =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb216-9" title="9">)</a>
<a class="sourceLine" id="cb216-10" title="10"></a>
<a class="sourceLine" id="cb216-11" title="11"><span class="co"># Simulating the bipartite ERGM,</span></a>
<a class="sourceLine" id="cb216-12" title="12">net_b &lt;-<span class="st"> </span><span class="kw">simulate</span>(net_b <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw">Log</span>(<span class="op">~</span><span class="kw">b1star</span>(<span class="dv">2</span>)), <span class="dt">coef =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="fl">1.5</span>), <span class="dt">seed =</span> <span class="dv">55</span>)</a></code></pre></div>
<p>Let’s see what we got here:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1"><span class="kw">summary</span>(net_b <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw">Log</span>(<span class="op">~</span><span class="kw">b1star</span>(<span class="dv">2</span>)))</a></code></pre></div>
<pre><code>##       edges Log~b1star2 
##  245.000000    5.746203</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1">netplot<span class="op">::</span><span class="kw">nplot</span>(net_b, <span class="dt">vertex.col =</span> (<span class="dv">1</span><span class="op">:</span>n <span class="op">&lt;=</span><span class="st"> </span>nactors) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="05-ergms-constrains_files/figure-html/05-example2-simulated-graph-1.png" width="672" /></p>
<p>Notice that the first <code>nactors</code> vertices in the network are the actors, and
the remaining are the entities. Now, although the <code>ergm</code> package features
bipartite network terms, we can still fit a bipartite ERGM without explicitly
declaring the graph as such. In such case, the <code>b1star(2)</code> term of a bipartite
network is equivalent to an <code>ostar(2)</code> in a directed graph. Likewise, <code>b2star(2)</code>
in a bipartite graph matches the <code>istar(2)</code> term in a directed graph. This
information will be relevant when fitting the ERGM. Let’s transform the bipartite
network into a directed graph. The following code block does so:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" title="1"><span class="co"># Identifying the edges</span></a>
<a class="sourceLine" id="cb220-2" title="2">net_not_b &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">as.matrix</span>(net_b) <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb220-3" title="3"></a>
<a class="sourceLine" id="cb220-4" title="4"><span class="co"># We need to offset the endpoint of the ties by nactors</span></a>
<a class="sourceLine" id="cb220-5" title="5"><span class="co"># so that the ids go from 1 through (nactors + nentitites)</span></a>
<a class="sourceLine" id="cb220-6" title="6">net_not_b[,<span class="dv">2</span>] &lt;-<span class="st"> </span>net_not_b[,<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>nactors</a>
<a class="sourceLine" id="cb220-7" title="7"></a>
<a class="sourceLine" id="cb220-8" title="8"><span class="co"># The resulting graph is a directed network</span></a>
<a class="sourceLine" id="cb220-9" title="9">net_not_b &lt;-<span class="st"> </span><span class="kw">network</span>(net_not_b, <span class="dt">directed =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Now we are almost done. As before, we need to use node-level covariates
to put the constraints in our model. For this ERGM to reflect an ERGM on
a bipartite network, we need two constraints:</p>
<ol style="list-style-type: decimal">
<li>Only ties from actors to entities are allowed, and</li>
<li>entities can only receive ties.</li>
</ol>
<p>The corresponding offset terms for this model are: <code>nodematch("is.actor") ~ -Inf</code>,
and <code>nodeocov("isnot.actor") ~ -Inf</code>. Mathematically:</p>
<p><span class="math display">\[\begin{align*}
\text{NodeMatch(x = &quot;is.actor&quot;)} &amp;= \sum_{i&lt;j} y_{ij}\mathbb{1}\left(x_i = x_j\right) \\
\text{NodeOCov(x = &quot;isnot.actor&quot;)} &amp;= \sum_{i} x_i \times \sum_{j&lt;i} y_{ij} 
\end{align*}\]</span></p>
<p>In other words, we are setting that ties between nodes of the same class are
forbidden, and outgoing ties are forbidden for entities. Let’s create the
vertex attributes needed to use the aforementioned terms:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1">net_not_b <span class="op">%v%</span><span class="st"> &quot;is.actor&quot;</span> &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="dv">1</span><span class="op">:</span>n <span class="op">&lt;=</span><span class="st"> </span>nactors)</a>
<a class="sourceLine" id="cb221-2" title="2">net_not_b <span class="op">%v%</span><span class="st"> &quot;isnot.actor&quot;</span> &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="dv">1</span><span class="op">:</span>n <span class="op">&gt;</span><span class="st"> </span>nactors)</a></code></pre></div>
<p>Finally, to make sure we have done all well, let’s look how both networks–bipartite
and unimodal–look side by side:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" title="1"><span class="co"># First, let&#39;s get the layout</span></a>
<a class="sourceLine" id="cb222-2" title="2">fig &lt;-<span class="st"> </span>netplot<span class="op">::</span><span class="kw">nplot</span>(net_b, <span class="dt">vertex.col =</span> (<span class="dv">1</span><span class="op">:</span>n <span class="op">&lt;=</span><span class="st"> </span>nactors) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb222-3" title="3">gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(</a>
<a class="sourceLine" id="cb222-4" title="4">  fig,</a>
<a class="sourceLine" id="cb222-5" title="5">  netplot<span class="op">::</span><span class="kw">nplot</span>(</a>
<a class="sourceLine" id="cb222-6" title="6">    net_not_b, <span class="dt">vertex.col =</span> (<span class="dv">1</span><span class="op">:</span>n <span class="op">&lt;=</span><span class="st"> </span>nactors) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb222-7" title="7">    <span class="dt">layout =</span> fig<span class="op">$</span>.layout</a>
<a class="sourceLine" id="cb222-8" title="8">     ),</a>
<a class="sourceLine" id="cb222-9" title="9">  <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb222-10" title="10">)</a></code></pre></div>
<p><img src="05-ergms-constrains_files/figure-html/05-example2-side-by-side-1.png" width="672" /></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1"><span class="co"># Looking at the counts</span></a>
<a class="sourceLine" id="cb223-2" title="2"><span class="kw">summary</span>(net_b <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw">b1star</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">b2star</span>(<span class="dv">2</span>))</a></code></pre></div>
<pre><code>##   edges b1star2 b2star2 
##     245     313     645</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1"><span class="kw">summary</span>(net_not_b <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw">ostar</span>(<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">istar</span>(<span class="dv">2</span>))</a></code></pre></div>
<pre><code>##  edges ostar2 istar2 
##    245    313    645</code></pre>
<p>With the two networks matching, we can now fit the ERGMs with and without
offset terms and compare the results between the two models:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1"><span class="co"># ERGM with a bipartite graph</span></a>
<a class="sourceLine" id="cb227-2" title="2">res_b     &lt;-<span class="st"> </span><span class="kw">ergm</span>(</a>
<a class="sourceLine" id="cb227-3" title="3">  <span class="co"># Main formula</span></a>
<a class="sourceLine" id="cb227-4" title="4">  net_b <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw">Log</span>(<span class="op">~</span><span class="kw">b1star</span>(<span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb227-5" title="5"></a>
<a class="sourceLine" id="cb227-6" title="6">  <span class="co"># Control parameters</span></a>
<a class="sourceLine" id="cb227-7" title="7">  <span class="dt">control =</span> <span class="kw">control.ergm</span>(<span class="dt">seed =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb227-8" title="8">  )</a>
<a class="sourceLine" id="cb227-9" title="9"></a>
<a class="sourceLine" id="cb227-10" title="10"><span class="co"># ERGM with a digraph with constraints</span></a>
<a class="sourceLine" id="cb227-11" title="11">res_not_b &lt;-<span class="st"> </span><span class="kw">ergm</span>(</a>
<a class="sourceLine" id="cb227-12" title="12">  <span class="co"># Main formula</span></a>
<a class="sourceLine" id="cb227-13" title="13">  net_not_b <span class="op">~</span><span class="st"> </span>edges <span class="op">+</span><span class="st"> </span><span class="kw">Log</span>(<span class="op">~</span><span class="kw">ostar</span>(<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb227-14" title="14"></a>
<a class="sourceLine" id="cb227-15" title="15"><span class="st">  </span><span class="co"># Offset terms </span></a>
<a class="sourceLine" id="cb227-16" title="16"><span class="st">  </span><span class="kw">offset</span>(<span class="kw">nodematch</span>(<span class="st">&quot;is.actor&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">nodeocov</span>(<span class="st">&quot;isnot.actor&quot;</span>)),</a>
<a class="sourceLine" id="cb227-17" title="17">  <span class="dt">offset.coef =</span> <span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="op">-</span><span class="ot">Inf</span>),</a>
<a class="sourceLine" id="cb227-18" title="18"></a>
<a class="sourceLine" id="cb227-19" title="19">  <span class="co"># Control parameters</span></a>
<a class="sourceLine" id="cb227-20" title="20">  <span class="dt">control =</span> <span class="kw">control.ergm</span>(<span class="dt">seed =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb227-21" title="21">  )</a></code></pre></div>
<p>Here are the estimates (using the <code>texreg</code> R package for a prettier output):</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" title="1">texreg<span class="op">::</span><span class="kw">screenreg</span>(<span class="kw">list</span>(<span class="dt">Bipartite =</span> res_b, <span class="dt">Directed =</span> res_not_b))</a></code></pre></div>
<pre><code>## 
## ======================================================================
##                               Bipartite    Directed                   
## ----------------------------------------------------------------------
## edges                           -3.14 ***                    -3.14 ***
##                                 (0.15)                       (0.14)   
## Log~b1star2                     21.86                                 
##                                (16.92)                                
## Log~ostar2                                                   21.62    
##                                                             (16.42)   
## offset(nodematch.is.actor)                                    -Inf    
##                                                                       
## offset(nodeocov.isnot.actor)                                  -Inf    
##                                                                       
## ----------------------------------------------------------------------
## AIC                           1958.11      -2134192392760919552.00    
## BIC                           1971.15      -2134192392760919552.00    
## Log Likelihood                -977.06       1067096196380459776.00    
## ======================================================================
## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
<p>As expected, both models yield the “same” estimate. The minor differences
observed between the models are how the <code>ergm</code> package performs
the sampling. In particular, in the bipartite case, <code>ergm</code> has special
routines for making the sampling more efficient, having a higher acceptance
rate than that of the model in which the bipartite graph was not explicitly
declared. We can tell this by inspecting rejection rates:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1"><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb230-2" title="2">  <span class="dt">Bipartite =</span> coda<span class="op">::</span><span class="kw">rejectionRate</span>(res_b<span class="op">$</span>sample[[<span class="dv">1</span>]]) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb230-3" title="3">  <span class="dt">Directed  =</span> coda<span class="op">::</span><span class="kw">rejectionRate</span>(res_not_b<span class="op">$</span>sample[[<span class="dv">1</span>]][, <span class="op">-</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb230-4" title="4">) <span class="op">|</span><span class="er">&gt;</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">caption =</span> <span class="st">&quot;Rejection rate (%)&quot;</span>)</a></code></pre></div>
<table>
<caption><span id="tab:05-example2-post-dist">Table 6.1: </span>Rejection rate (%)</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Bipartite</th>
<th align="right">Directed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">edges</td>
<td align="right">2.53</td>
<td align="right">4.62</td>
</tr>
<tr class="even">
<td align="left">Log~b1star2</td>
<td align="right">0.84</td>
<td align="right">2.82</td>
</tr>
</tbody>
</table>
<p>The ERGM fitted with the offset terms has a much higher rejection rate
than that of the ERGM fitted with the bipartite ERGM.</p>
<p>Finally, the fact that we can fit ERGMs using offset does not mean that
we need to use it ALL the time. Unless there is a very good reason to
go around <code>ergm</code>’s capabilities, I wouldn’t recommend fitting bipartite
ERGMs as we just did, as the authors of the package have included (MANY)
features to make our job easier.</p>

</div>
<!-- </div> -->
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>After writing this example, it became apparent the use of
the <code>Log()</code> transformation function may not be ideal. Since many terms used
in ERGMs can be zero, e.g., triangles, the term <code>Log(~ ostar(2))</code> is undefined
when <code>ostar(2) = 0</code>. In practice, the ERGM package sets a lower limit for the
log of 0, so, instead of having <code>Log(0) ~ -Inf</code>, they set it to be a really
large negative number. This causes all sorts of issues to the estimates; in
our example, an over estimation of the population parameter and a really
negative likelihood function. With that said, I wouldn’t recommend using
this transformation too often.<a href="example-2-bi-partite-networks.html#fnref11" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="example-1-interlocking-egos-and-disconnected-alters.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="separable-temporal-exponential-family-random-graph-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/gvegayon/appliedsnar/edit/master/05-ergms-constrains.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/gvegayon/appliedsnar/blob/master/05-ergms-constrains.Rmd",
"text": null
},
"download": ["appliedsnar.pdf", "appliedsnar.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
