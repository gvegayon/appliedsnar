<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12.4 Statistical inference | Applied Network Science with R</title>
  <meta name="description" content="An improvised book on applied Network Science with R." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="12.4 Statistical inference | Applied Network Science with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An improvised book on applied Network Science with R." />
  <meta name="github-repo" content="gvegayon/appliedsnar" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12.4 Statistical inference | Applied Network Science with R" />
  
  <meta name="twitter:description" content="An improvised book on applied Network Science with R." />
  

<meta name="author" content="George G. Vega Yon, Ph.D." />


<meta name="date" content="2024-01-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulation-of-diffusion-processes.html"/>
<link rel="next" href="stochastic-actor-oriented-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-40608305-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-40608305-4');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Network Science with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i><b>2</b> About the Author</a></li>
<li class="part"><span><b>I Applications</b></span></li>
<li class="chapter" data-level="3" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>3</b> Introduction</a></li>
<li class="chapter" data-level="4" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>4</b> R Basics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>4.1</b> What is R</a></li>
<li class="chapter" data-level="4.2" data-path="how-to-install-packages.html"><a href="how-to-install-packages.html"><i class="fa fa-check"></i><b>4.2</b> How to install packages</a></li>
<li class="chapter" data-level="4.3" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>4.3</b> Prerequisites</a></li>
<li class="chapter" data-level="4.4" data-path="a-gentle-quick-n-dirty-introduction-to-r.html"><a href="a-gentle-quick-n-dirty-introduction-to-r.html"><i class="fa fa-check"></i><b>4.4</b> A <del>gentle</del> Quick n’ Dirty Introduction to R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="network-nomination-data.html"><a href="network-nomination-data.html"><i class="fa fa-check"></i><b>5</b> Network Nomination Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html"><i class="fa fa-check"></i><b>5.1</b> Data preprocessing</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-preprocessing.html"><a href="data-preprocessing.html#reading-the-data-into-r"><i class="fa fa-check"></i><b>5.1.1</b> Reading the data into R</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-preprocessing.html"><a href="data-preprocessing.html#creating-a-unique-id-for-each-participant"><i class="fa fa-check"></i><b>5.1.2</b> Creating a unique id for each participant</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="creating-a-network.html"><a href="creating-a-network.html"><i class="fa fa-check"></i><b>5.2</b> Creating a network</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="creating-a-network.html"><a href="creating-a-network.html#from-survey-to-edgelist"><i class="fa fa-check"></i><b>5.2.1</b> From survey to edgelist</a></li>
<li class="chapter" data-level="5.2.2" data-path="creating-a-network.html"><a href="creating-a-network.html#igraph-network"><i class="fa fa-check"></i><b>5.2.2</b> igraph network</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="network-descriptive-stats.html"><a href="network-descriptive-stats.html"><i class="fa fa-check"></i><b>5.3</b> Network descriptive stats</a></li>
<li class="chapter" data-level="5.4" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html"><i class="fa fa-check"></i><b>5.4</b> Plotting the network in igraph</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#single-plot"><i class="fa fa-check"></i><b>5.4.1</b> Single plot</a></li>
<li class="chapter" data-level="5.4.2" data-path="plotting-the-network-in-igraph.html"><a href="plotting-the-network-in-igraph.html#multiple-plots"><i class="fa fa-check"></i><b>5.4.2</b> Multiple plots</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>5.5</b> Statistical tests</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="statistical-tests.html"><a href="statistical-tests.html#is-nomination-number-correlated-with-indegree"><i class="fa fa-check"></i><b>5.5.1</b> Is nomination number correlated with indegree?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exponential-random-graph-models.html"><a href="exponential-random-graph-models.html"><i class="fa fa-check"></i><b>6</b> Exponential Random Graph Models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="a-naïve-example.html"><a href="a-naïve-example.html"><i class="fa fa-check"></i><b>6.1</b> A naïve example</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-of-ergms.html"><a href="estimation-of-ergms.html"><i class="fa fa-check"></i><b>6.2</b> Estimation of ERGMs</a></li>
<li class="chapter" data-level="6.3" data-path="the-ergm-package.html"><a href="the-ergm-package.html"><i class="fa fa-check"></i><b>6.3</b> The <code>ergm</code> package</a></li>
<li class="chapter" data-level="6.4" data-path="running-ergms.html"><a href="running-ergms.html"><i class="fa fa-check"></i><b>6.4</b> Running ERGMs</a></li>
<li class="chapter" data-level="6.5" data-path="model-goodness-of-fit.html"><a href="model-goodness-of-fit.html"><i class="fa fa-check"></i><b>6.5</b> Model Goodness-of-Fit</a></li>
<li class="chapter" data-level="6.6" data-path="more-on-mcmc-convergence.html"><a href="more-on-mcmc-convergence.html"><i class="fa fa-check"></i><b>6.6</b> More on MCMC convergence</a></li>
<li class="chapter" data-level="6.7" data-path="mathematical-interpretation.html"><a href="mathematical-interpretation.html"><i class="fa fa-check"></i><b>6.7</b> Mathematical Interpretation</a></li>
<li class="chapter" data-level="6.8" data-path="markov-independence.html"><a href="markov-independence.html"><i class="fa fa-check"></i><b>6.8</b> Markov independence</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="using-constraints-in-ergms.html"><a href="using-constraints-in-ergms.html"><i class="fa fa-check"></i><b>7</b> Using constraints in ERGMs</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example-1-interlocking-egos-and-disconnected-alters.html"><a href="example-1-interlocking-egos-and-disconnected-alters.html"><i class="fa fa-check"></i><b>7.1</b> Example 1: Interlocking egos and disconnected alters</a></li>
<li class="chapter" data-level="7.2" data-path="example-2-bi-partite-networks.html"><a href="example-2-bi-partite-networks.html"><i class="fa fa-check"></i><b>7.2</b> Example 2: Bi-partite networks</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="separable-temporal-exponential-family-random-graph-models.html"><a href="separable-temporal-exponential-family-random-graph-models.html"><i class="fa fa-check"></i><b>8</b> (Separable) Temporal Exponential Family Random Graph Models</a></li>
<li class="chapter" data-level="9" data-path="simulating-and-visualizing-networks.html"><a href="simulating-and-visualizing-networks.html"><i class="fa fa-check"></i><b>9</b> Simulating and visualizing networks</a>
<ul>
<li class="chapter" data-level="9.1" data-path="random-graph-models.html"><a href="random-graph-models.html"><i class="fa fa-check"></i><b>9.1</b> Random Graph Models</a></li>
<li class="chapter" data-level="9.2" data-path="social-networks-in-schools.html"><a href="social-networks-in-schools.html"><i class="fa fa-check"></i><b>9.2</b> Social Networks in Schools</a></li>
<li class="chapter" data-level="9.3" data-path="reading-a-network.html"><a href="reading-a-network.html"><i class="fa fa-check"></i><b>9.3</b> Reading a network</a></li>
<li class="chapter" data-level="9.4" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html"><i class="fa fa-check"></i><b>9.4</b> Visualizing the network</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html#vertex-size"><i class="fa fa-check"></i><b>9.4.1</b> Vertex size</a></li>
<li class="chapter" data-level="9.4.2" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html#vertex-color"><i class="fa fa-check"></i><b>9.4.2</b> Vertex color</a></li>
<li class="chapter" data-level="9.4.3" data-path="visualizing-the-network.html"><a href="visualizing-the-network.html#vertex-shape"><i class="fa fa-check"></i><b>9.4.3</b> Vertex shape</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="egocentric-networks.html"><a href="egocentric-networks.html"><i class="fa fa-check"></i><b>10</b> Egocentric networks</a>
<ul>
<li class="chapter" data-level="10.1" data-path="network-files-graphml.html"><a href="network-files-graphml.html"><i class="fa fa-check"></i><b>10.1</b> Network files (graphml)</a></li>
<li class="chapter" data-level="10.2" data-path="person-files.html"><a href="person-files.html"><i class="fa fa-check"></i><b>10.2</b> Person files</a></li>
<li class="chapter" data-level="10.3" data-path="ego-files.html"><a href="ego-files.html"><i class="fa fa-check"></i><b>10.3</b> Ego files</a></li>
<li class="chapter" data-level="10.4" data-path="edgelist-files.html"><a href="edgelist-files.html"><i class="fa fa-check"></i><b>10.4</b> Edgelist files</a></li>
<li class="chapter" data-level="10.5" data-path="putting-all-together.html"><a href="putting-all-together.html"><i class="fa fa-check"></i><b>10.5</b> Putting all together</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="putting-all-together.html"><a href="putting-all-together.html#generating-statistics-using-igraph"><i class="fa fa-check"></i><b>10.5.1</b> Generating statistics using igraph</a></li>
<li class="chapter" data-level="10.5.2" data-path="putting-all-together.html"><a href="putting-all-together.html#generating-statistics-based-on-ergm"><i class="fa fa-check"></i><b>10.5.2</b> Generating statistics based on ergm</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="saving-the-data.html"><a href="saving-the-data.html"><i class="fa fa-check"></i><b>10.6</b> Saving the data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hypothesis-testing-in-networks.html"><a href="hypothesis-testing-in-networks.html"><i class="fa fa-check"></i><b>11</b> Hypothesis testing in networks</a>
<ul>
<li class="chapter" data-level="11.1" data-path="comparing-networks.html"><a href="comparing-networks.html"><i class="fa fa-check"></i><b>11.1</b> Comparing networks</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="comparing-networks.html"><a href="comparing-networks.html#network-bootstrap"><i class="fa fa-check"></i><b>11.1.1</b> Network bootstrap</a></li>
<li class="chapter" data-level="11.1.2" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-normal"><i class="fa fa-check"></i><b>11.1.2</b> When the statistic is normal</a></li>
<li class="chapter" data-level="11.1.3" data-path="comparing-networks.html"><a href="comparing-networks.html#when-the-statistic-is-not-normal"><i class="fa fa-check"></i><b>11.1.3</b> When the statistic is NOT normal</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>11.2</b> Examples</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="examples.html"><a href="examples.html#average-of-node-level-stats"><i class="fa fa-check"></i><b>11.2.1</b> Average of node-level stats</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="network-diffussion-with-netdiffuser.html"><a href="network-diffussion-with-netdiffuser.html"><i class="fa fa-check"></i><b>12</b> Network diffussion with <code>netdiffuseR</code></a>
<ul>
<li class="chapter" data-level="12.1" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html"><i class="fa fa-check"></i><b>12.1</b> Network diffusion of innovation</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html#diffusion-networks"><i class="fa fa-check"></i><b>12.1.1</b> Diffusion networks</a></li>
<li class="chapter" data-level="12.1.2" data-path="network-diffusion-of-innovation.html"><a href="network-diffusion-of-innovation.html#thresholds"><i class="fa fa-check"></i><b>12.1.2</b> Thresholds</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html"><i class="fa fa-check"></i><b>12.2</b> The netdiffuseR R package</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#overview"><i class="fa fa-check"></i><b>12.2.1</b> Overview</a></li>
<li class="chapter" data-level="12.2.2" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#datasets"><i class="fa fa-check"></i><b>12.2.2</b> Datasets</a></li>
<li class="chapter" data-level="12.2.3" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#visualization-methods"><i class="fa fa-check"></i><b>12.2.3</b> Visualization methods</a></li>
<li class="chapter" data-level="12.2.4" data-path="the-netdiffuser-r-package.html"><a href="the-netdiffuser-r-package.html#problems"><i class="fa fa-check"></i><b>12.2.4</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html"><i class="fa fa-check"></i><b>12.3</b> Simulation of diffusion processes</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#simulating-diffusion-networks"><i class="fa fa-check"></i><b>12.3.1</b> Simulating diffusion networks</a></li>
<li class="chapter" data-level="12.3.2" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#rumor-spreading"><i class="fa fa-check"></i><b>12.3.2</b> Rumor spreading</a></li>
<li class="chapter" data-level="12.3.3" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#difussion"><i class="fa fa-check"></i><b>12.3.3</b> Difussion</a></li>
<li class="chapter" data-level="12.3.4" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#mentor-matching"><i class="fa fa-check"></i><b>12.3.4</b> Mentor Matching</a></li>
<li class="chapter" data-level="12.3.5" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#example-by-changing-threshold"><i class="fa fa-check"></i><b>12.3.5</b> Example by changing threshold</a></li>
<li class="chapter" data-level="12.3.6" data-path="simulation-of-diffusion-processes.html"><a href="simulation-of-diffusion-processes.html#problems-1"><i class="fa fa-check"></i><b>12.3.6</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>12.4</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="statistical-inference.html"><a href="statistical-inference.html#morans-i"><i class="fa fa-check"></i><b>12.4.1</b> Moran’s I</a></li>
<li class="chapter" data-level="12.4.2" data-path="statistical-inference.html"><a href="statistical-inference.html#using-geodesics"><i class="fa fa-check"></i><b>12.4.2</b> Using geodesics</a></li>
<li class="chapter" data-level="12.4.3" data-path="statistical-inference.html"><a href="statistical-inference.html#structural-dependence-and-permutation-tests"><i class="fa fa-check"></i><b>12.4.3</b> Structural dependence and permutation tests</a></li>
<li class="chapter" data-level="12.4.4" data-path="statistical-inference.html"><a href="statistical-inference.html#idea"><i class="fa fa-check"></i><b>12.4.4</b> Idea</a></li>
<li class="chapter" data-level="12.4.5" data-path="statistical-inference.html"><a href="statistical-inference.html#regression-analysis"><i class="fa fa-check"></i><b>12.4.5</b> Regression analysis</a></li>
<li class="chapter" data-level="12.4.6" data-path="statistical-inference.html"><a href="statistical-inference.html#problems-2"><i class="fa fa-check"></i><b>12.4.6</b> Problems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="stochastic-actor-oriented-models.html"><a href="stochastic-actor-oriented-models.html"><i class="fa fa-check"></i><b>13</b> Stochastic Actor Oriented Models</a></li>
<li class="chapter" data-level="14" data-path="power-calculation-in-network-studies.html"><a href="power-calculation-in-network-studies.html"><i class="fa fa-check"></i><b>14</b> Power calculation in network studies</a>
<ul>
<li class="chapter" data-level="14.1" data-path="example-1-spillover-effects-in-egocentric-studiescredit-ego-power.html"><a href="example-1-spillover-effects-in-egocentric-studiescredit-ego-power.html"><i class="fa fa-check"></i><b>14.1</b> Example 1: Spillover effects in egocentric studies</a></li>
<li class="chapter" data-level="14.2" data-path="example-2-spillover-effects-pre-post-effect.html"><a href="example-2-spillover-effects-pre-post-effect.html"><i class="fa fa-check"></i><b>14.2</b> Example 2: Spillover effects pre-post effect</a></li>
<li class="chapter" data-level="14.3" data-path="example-3-first-difference.html"><a href="example-3-first-difference.html"><i class="fa fa-check"></i><b>14.3</b> Example 3: First difference</a></li>
</ul></li>
<li class="part"><span><b>II Statistical Foundations</b></span></li>
<li class="chapter" data-level="15" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>15</b> Bayes’ Rule</a></li>
<li class="chapter" data-level="16" data-path="markov-chain.html"><a href="markov-chain.html"><i class="fa fa-check"></i><b>16</b> Markov Chain</a>
<ul>
<li class="chapter" data-level="16.1" data-path="metropolis-algorithm.html"><a href="metropolis-algorithm.html"><i class="fa fa-check"></i><b>16.1</b> Metropolis Algorithm</a></li>
<li class="chapter" data-level="16.2" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i><b>16.2</b> Metropolis-Hastings</a></li>
<li class="chapter" data-level="16.3" data-path="likelihood-free-mcmc.html"><a href="likelihood-free-mcmc.html"><i class="fa fa-check"></i><b>16.3</b> Likelihood-free MCMC</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="part2-power.html"><a href="part2-power.html"><i class="fa fa-check"></i><b>17</b> Power and sample size</a>
<ul>
<li class="chapter" data-level="17.1" data-path="error-types.html"><a href="error-types.html"><i class="fa fa-check"></i><b>17.1</b> Error types</a></li>
<li class="chapter" data-level="17.2" data-path="example-1-sample-size-for-a-proportion.html"><a href="example-1-sample-size-for-a-proportion.html"><i class="fa fa-check"></i><b>17.2</b> Example 1: Sample size for a proportion</a></li>
<li class="chapter" data-level="17.3" data-path="example-2-sample-size-for-a-proportion-vis.html"><a href="example-2-sample-size-for-a-proportion-vis.html"><i class="fa fa-check"></i><b>17.3</b> Example 2: Sample size for a proportion (vis)</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="datasets-1.html"><a href="datasets-1.html"><i class="fa fa-check"></i><b>A</b> Datasets</a>
<ul>
<li class="chapter" data-level="A.1" data-path="sns-data.html"><a href="sns-data.html"><i class="fa fa-check"></i><b>A.1</b> SNS data</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="sns-data.html"><a href="sns-data.html#about-the-data"><i class="fa fa-check"></i><b>A.1.1</b> About the data</a></li>
<li class="chapter" data-level="A.1.2" data-path="sns-data.html"><a href="sns-data.html#variables"><i class="fa fa-check"></i><b>A.1.2</b> Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Network Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-inference" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Statistical inference<a href="statistical-inference.html#statistical-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="morans-i" class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Moran’s I<a href="statistical-inference.html#morans-i" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Moran’s I tests for spatial autocorrelation.</p></li>
<li><p><strong>netdiffuseR</strong> implements the test in <code>moran</code>, which is suited for sparse matrices.</p></li>
<li><p>We can use Moran’s I as a first look to whether there is something happening:
let that be influence or homophily.</p></li>
</ul>
</div>
<div id="using-geodesics" class="section level3 hasAnchor" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Using geodesics<a href="statistical-inference.html#using-geodesics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>One approach is to use the geodesic (shortest path length) matrix to account for indirect
influence.</p></li>
<li><p>In the case of sparse matrices, and furthermore, in the presence of structural holes
it is more convenient to calculate the distance matrix taking this into account.</p></li>
<li><p><strong>netdiffuseR</strong> has a function to do so, the <code>approx_geodesic</code> function, which,
using graph powers, computes the shortest path up to <code>n</code> steps. This could be
faster (if you only care up to <code>n</code> steps) than <code>igraph</code> or <code>sns</code>:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="statistical-inference.html#cb282-1" tabindex="-1"></a><span class="co"># Extracting the large adjacency matrix (stacked)</span></span>
<span id="cb282-2"><a href="statistical-inference.html#cb282-2" tabindex="-1"></a>dgc <span class="ot">&lt;-</span> <span class="fu">diag_expand</span>(medInnovationsDiffNet<span class="sc">$</span>graph)</span>
<span id="cb282-3"><a href="statistical-inference.html#cb282-3" tabindex="-1"></a>ig  <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(dgc)</span>
<span id="cb282-4"><a href="statistical-inference.html#cb282-4" tabindex="-1"></a>mat <span class="ot">&lt;-</span> network<span class="sc">::</span><span class="fu">as.network</span>(<span class="fu">as.matrix</span>(dgc))</span>
<span id="cb282-5"><a href="statistical-inference.html#cb282-5" tabindex="-1"></a></span>
<span id="cb282-6"><a href="statistical-inference.html#cb282-6" tabindex="-1"></a><span class="co"># Measuring times</span></span>
<span id="cb282-7"><a href="statistical-inference.html#cb282-7" tabindex="-1"></a>times <span class="ot">&lt;-</span> microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb282-8"><a href="statistical-inference.html#cb282-8" tabindex="-1"></a>  <span class="at">netdiffuseR =</span> netdiffuseR<span class="sc">::</span><span class="fu">approx_geodesic</span>(dgc),</span>
<span id="cb282-9"><a href="statistical-inference.html#cb282-9" tabindex="-1"></a>  <span class="at">igraph =</span> igraph<span class="sc">::</span><span class="fu">distances</span>(ig),</span>
<span id="cb282-10"><a href="statistical-inference.html#cb282-10" tabindex="-1"></a>  <span class="at">sna =</span> sna<span class="sc">::</span><span class="fu">geodist</span>(mat),</span>
<span id="cb282-11"><a href="statistical-inference.html#cb282-11" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">50</span>, <span class="at">unit=</span><span class="st">&quot;ms&quot;</span></span>
<span id="cb282-12"><a href="statistical-inference.html#cb282-12" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="part-01-09-netdiffuser_files/figure-html/geodesic_speed-box-1.png" width="672" /></p></li>
<li><p>The <code>summary.diffnet</code> method already runs Moran’s for you. What happens under the hood is:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="statistical-inference.html#cb283-1" tabindex="-1"></a><span class="co"># For each time point we compute the geodesic distances matrix</span></span>
<span id="cb283-2"><a href="statistical-inference.html#cb283-2" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">approx_geodesic</span>(medInnovationsDiffNet<span class="sc">$</span>graph[[<span class="dv">1</span>]])</span>
<span id="cb283-3"><a href="statistical-inference.html#cb283-3" tabindex="-1"></a></span>
<span id="cb283-4"><a href="statistical-inference.html#cb283-4" tabindex="-1"></a><span class="co"># We get the element-wise inverse</span></span>
<span id="cb283-5"><a href="statistical-inference.html#cb283-5" tabindex="-1"></a>W<span class="sc">@</span>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>W<span class="sc">@</span>x</span>
<span id="cb283-6"><a href="statistical-inference.html#cb283-6" tabindex="-1"></a></span>
<span id="cb283-7"><a href="statistical-inference.html#cb283-7" tabindex="-1"></a><span class="co"># And then compute moran</span></span>
<span id="cb283-8"><a href="statistical-inference.html#cb283-8" tabindex="-1"></a><span class="fu">moran</span>(medInnovationsDiffNet<span class="sc">$</span>cumadopt[,<span class="dv">1</span>], W)</span></code></pre></div>
<pre><code>## $observed
## [1] 0.06624028
## 
## $expected
## [1] -0.008064516
## 
## $sd
## [1] 0.03265066
## 
## $p.value
## [1] 0.02286087
## 
## attr(,&quot;class&quot;)
## [1] &quot;diffnet_moran&quot;</code></pre></li>
</ul>
</div>
<div id="structural-dependence-and-permutation-tests" class="section level3 hasAnchor" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> Structural dependence and permutation tests<a href="statistical-inference.html#structural-dependence-and-permutation-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>A novel statistical method (work-in-progress) that allows conducting inference.</li>
<li>Included in the package, tests whether a particular network statistic depends on network structure</li>
<li>Suitable to be applied to network thresholds (you can’t use thresholds in regression-like models!)</li>
</ul>
</div>
<div id="idea" class="section level3 hasAnchor" number="12.4.4">
<h3><span class="header-section-number">12.4.4</span> Idea<a href="statistical-inference.html#idea" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Let <span class="math inline">\(\mathcal{G} = (V,E)\)</span> be a graph, <span class="math inline">\(\gamma\)</span> a vertex attribute, and <span class="math inline">\(\beta = f(\gamma,\mathcal{G})\)</span>, then</p>
<p><span class="math display">\[\gamma \perp \mathcal{G} \implies \mathbb{E}\left[\beta(\gamma,\mathcal{G})|\mathcal{G}\right] = \mathbb{E}\left[\beta(\gamma,\mathcal{G})\right]\]</span></p></li>
<li><p>This is, if for example time of adoption is independent on the structure of the network, then the average threshold level will be independent from the network structure as well.</p></li>
<li><p>Another way of looking at this is that the test will allow us to see how probable is to have this combination of network structure and network threshold (if it is uncommon then we say that the diffusion model is highly likely)</p></li>
</ul>
<div id="example-not-random-toa" class="section level4 hasAnchor" number="12.4.4.1">
<h4><span class="header-section-number">12.4.4.1</span> Example Not random TOA<a href="statistical-inference.html#example-not-random-toa" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><pre><code>To use this test, __netdiffuseR__ has the `struct_test` function.</code></pre></li>
<li><pre><code>It simulates networks with the same density, and computes a particular statistic every time, generating an EDF (Empirical Distribution Function) under the Null hypothesis (p-values).</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="statistical-inference.html#cb287-1" tabindex="-1"></a><span class="co"># Simulating network</span></span>
<span id="cb287-2"><a href="statistical-inference.html#cb287-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1123</span>)</span>
<span id="cb287-3"><a href="statistical-inference.html#cb287-3" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">rdiffnet</span>(<span class="at">n=</span><span class="dv">500</span>, <span class="at">t=</span><span class="dv">10</span>, <span class="at">seed.graph =</span> <span class="st">&quot;small-world&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in (function (graph, p, algorithm = &quot;endpoints&quot;, both.ends = FALSE, :
## The option -copy.first- is set to TRUE. In this case, the first graph will be
## treated as a baseline, and thus, networks after T=1 will be replaced with T-1.</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="statistical-inference.html#cb289-1" tabindex="-1"></a><span class="co"># Running the test</span></span>
<span id="cb289-2"><a href="statistical-inference.html#cb289-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">struct_test</span>(</span>
<span id="cb289-3"><a href="statistical-inference.html#cb289-3" tabindex="-1"></a>  <span class="at">graph     =</span> net, </span>
<span id="cb289-4"><a href="statistical-inference.html#cb289-4" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">threshold</span>(x), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb289-5"><a href="statistical-inference.html#cb289-5" tabindex="-1"></a>  <span class="at">R         =</span> <span class="fl">1e3</span>,</span>
<span id="cb289-6"><a href="statistical-inference.html#cb289-6" tabindex="-1"></a>  <span class="at">ncpus=</span><span class="dv">4</span>, <span class="at">parallel=</span><span class="st">&quot;multicore&quot;</span></span>
<span id="cb289-7"><a href="statistical-inference.html#cb289-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning in (function (graph, p, algorithm = &quot;endpoints&quot;, both.ends = FALSE, :
## The option -copy.first- is set to TRUE. In this case, the first graph will be
## treated as a baseline, and thus, networks after T=1 will be replaced with T-1.</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="statistical-inference.html#cb291-1" tabindex="-1"></a><span class="co"># See the output</span></span>
<span id="cb291-2"><a href="statistical-inference.html#cb291-2" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>## 
## Structure dependence test
## # Simulations     : 1,000
## # nodes           : 500
## # of time periods : 10
## --------------------------------------------------------------------------------
##  H0: E[beta(Y,G)|G] - E[beta(Y,G)] = 0 (no structure dependency)
##     observed    expected       p.val
##       0.5513      0.2523      0.0000</code></pre></li>
</ul>
<p><img src="part-01-09-netdiffuser_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ul>
<li><p>Now we shuffle times of adoption, so that is random</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="statistical-inference.html#cb293-1" tabindex="-1"></a><span class="co"># Resetting TOAs (now will be completely random)</span></span>
<span id="cb293-2"><a href="statistical-inference.html#cb293-2" tabindex="-1"></a><span class="fu">diffnet.toa</span>(net) <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">diffnet.toa</span>(net), <span class="fu">nnodes</span>(net), <span class="cn">TRUE</span>)</span>
<span id="cb293-3"><a href="statistical-inference.html#cb293-3" tabindex="-1"></a></span>
<span id="cb293-4"><a href="statistical-inference.html#cb293-4" tabindex="-1"></a><span class="co"># Running the test</span></span>
<span id="cb293-5"><a href="statistical-inference.html#cb293-5" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">struct_test</span>(</span>
<span id="cb293-6"><a href="statistical-inference.html#cb293-6" tabindex="-1"></a>  <span class="at">graph     =</span> net, </span>
<span id="cb293-7"><a href="statistical-inference.html#cb293-7" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">threshold</span>(x), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb293-8"><a href="statistical-inference.html#cb293-8" tabindex="-1"></a>  <span class="at">R         =</span> <span class="fl">1e3</span>,</span>
<span id="cb293-9"><a href="statistical-inference.html#cb293-9" tabindex="-1"></a>  <span class="at">ncpus=</span><span class="dv">4</span>, <span class="at">parallel=</span><span class="st">&quot;multicore&quot;</span></span>
<span id="cb293-10"><a href="statistical-inference.html#cb293-10" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning in (function (graph, p, algorithm = &quot;endpoints&quot;, both.ends = FALSE, :
## The option -copy.first- is set to TRUE. In this case, the first graph will be
## treated as a baseline, and thus, networks after T=1 will be replaced with T-1.</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="statistical-inference.html#cb295-1" tabindex="-1"></a><span class="co"># See the output</span></span>
<span id="cb295-2"><a href="statistical-inference.html#cb295-2" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>## 
## Structure dependence test
## # Simulations     : 1,000
## # nodes           : 500
## # of time periods : 10
## --------------------------------------------------------------------------------
##  H0: E[beta(Y,G)|G] - E[beta(Y,G)] = 0 (no structure dependency)
##     observed    expected       p.val
##       0.2714      0.2586      0.4220</code></pre>
<p><img src="part-01-09-netdiffuser_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p></li>
</ul>
</div>
</div>
<div id="regression-analysis" class="section level3 hasAnchor" number="12.4.5">
<h3><span class="header-section-number">12.4.5</span> Regression analysis<a href="statistical-inference.html#regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>In regression analysis, we want to see if exposure, once we control for other
covariates had any effect on the adoption of a behavior.</p></li>
<li><p>In general, the big problem here is when we have a latent variable that
co-determines both network and behavior.</p></li>
<li><p>Unless we can control for such variable, regression analysis will be
generically biased.</p></li>
<li><p>On the other hand, if you can claim that either such variable doesn’t exist
or you actually can control for it, then we have two options: lagged exposure
models or contemporaneous exposure models. We will focus on the former.</p></li>
</ul>
<div id="lagged-exposure-models" class="section level4 hasAnchor" number="12.4.5.1">
<h4><span class="header-section-number">12.4.5.1</span> Lagged exposure models<a href="statistical-inference.html#lagged-exposure-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>In this type of model, we usually have the following</p>
<p><span class="math display">\[
y_t = f(W_{t-1}, y_{t-1}, X_i) + \varepsilon
\]</span></p>
<p>Furthermore, in the case of adoption, we have</p>
<p><span class="math display">\[
y_{it} = \left\{
\begin{array}{ll}
1 &amp; \mbox{if}\quad \rho\sum_{j\neq i}\frac{W_{ijt-1}y_{it-1}}{\sum_{j\neq i}W_{ijt-1}} + X_{it}\beta &gt; 0\\
0 &amp; \mbox{otherwise}
\end{array}
\right.
\]</span></p></li>
<li><p>In netdiffuseR is as easy as doing the following:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="statistical-inference.html#cb297-1" tabindex="-1"></a><span class="co"># fakedata</span></span>
<span id="cb297-2"><a href="statistical-inference.html#cb297-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">121</span>)</span>
<span id="cb297-3"><a href="statistical-inference.html#cb297-3" tabindex="-1"></a></span>
<span id="cb297-4"><a href="statistical-inference.html#cb297-4" tabindex="-1"></a>W   <span class="ot">&lt;-</span> <span class="fu">rgraph_ws</span>(<span class="fl">1e3</span>, <span class="dv">8</span>, .<span class="dv">2</span>)</span>
<span id="cb297-5"><a href="statistical-inference.html#cb297-5" tabindex="-1"></a>X   <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">var1 =</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>))</span>
<span id="cb297-6"><a href="statistical-inference.html#cb297-6" tabindex="-1"></a>toa <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="fl">1e3</span>, <span class="cn">TRUE</span>)</span>
<span id="cb297-7"><a href="statistical-inference.html#cb297-7" tabindex="-1"></a></span>
<span id="cb297-8"><a href="statistical-inference.html#cb297-8" tabindex="-1"></a>dn  <span class="ot">&lt;-</span> <span class="fu">new_diffnet</span>(W, <span class="at">toa=</span>toa, <span class="at">vertex.static.attrs =</span> X)</span></code></pre></div>
<pre><code>## Warning in new_diffnet(W, toa = toa, vertex.static.attrs = X): -graph- is
## static and will be recycled (see ?new_diffnet).</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="statistical-inference.html#cb299-1" tabindex="-1"></a><span class="co"># Computing exposure and adoption for regression</span></span>
<span id="cb299-2"><a href="statistical-inference.html#cb299-2" tabindex="-1"></a>dn[[<span class="st">&quot;cohesive_expo&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="cn">NA</span>, <span class="fu">exposure</span>(dn)[,<span class="sc">-</span><span class="fu">nslices</span>(dn)])</span>
<span id="cb299-3"><a href="statistical-inference.html#cb299-3" tabindex="-1"></a>dn[[<span class="st">&quot;adopt&quot;</span>]]         <span class="ot">&lt;-</span> dn<span class="sc">$</span>cumadopt</span>
<span id="cb299-4"><a href="statistical-inference.html#cb299-4" tabindex="-1"></a></span>
<span id="cb299-5"><a href="statistical-inference.html#cb299-5" tabindex="-1"></a><span class="co"># Generating the data and running the model</span></span>
<span id="cb299-6"><a href="statistical-inference.html#cb299-6" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dn)</span>
<span id="cb299-7"><a href="statistical-inference.html#cb299-7" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">glm</span>(adopt <span class="sc">~</span> cohesive_expo <span class="sc">+</span> var1 <span class="sc">+</span> <span class="fu">factor</span>(per),</span>
<span id="cb299-8"><a href="statistical-inference.html#cb299-8" tabindex="-1"></a>           <span class="at">data =</span> dat,</span>
<span id="cb299-9"><a href="statistical-inference.html#cb299-9" tabindex="-1"></a>           <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;probit&quot;</span>),</span>
<span id="cb299-10"><a href="statistical-inference.html#cb299-10" tabindex="-1"></a>           <span class="at">subset =</span> <span class="fu">is.na</span>(toa) <span class="sc">|</span> (per <span class="sc">&lt;=</span> toa))</span>
<span id="cb299-11"><a href="statistical-inference.html#cb299-11" tabindex="-1"></a><span class="fu">summary</span>(ans)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = adopt ~ cohesive_expo + var1 + factor(per), family = binomial(link = &quot;probit&quot;), 
##     data = dat, subset = is.na(toa) | (per &lt;= toa))
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -0.92777    0.05840 -15.888  &lt; 2e-16 ***
## cohesive_expo  0.23839    0.17514   1.361 0.173452    
## var1          -0.04623    0.02704  -1.710 0.087334 .  
## factor(per)3   0.29313    0.07715   3.799 0.000145 ***
## factor(per)4   0.33902    0.09897   3.425 0.000614 ***
## factor(per)5   0.59851    0.12193   4.909 9.18e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2745.1  on 2317  degrees of freedom
## Residual deviance: 2663.5  on 2312  degrees of freedom
##   (1000 observations deleted due to missingness)
## AIC: 2675.5
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Alternatively, we could have used the new function <code>diffreg</code></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="statistical-inference.html#cb301-1" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">diffreg</span>(dn <span class="sc">~</span> exposure <span class="sc">+</span> var1 <span class="sc">+</span> <span class="fu">factor</span>(per), <span class="at">type =</span> <span class="st">&quot;probit&quot;</span>)</span>
<span id="cb301-2"><a href="statistical-inference.html#cb301-2" tabindex="-1"></a><span class="fu">summary</span>(ans)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Adopt ~ exposure + var1 + factor(per), family = binomial(link = &quot;probit&quot;), 
##     data = dat, subset = ifelse(is.na(toa), TRUE, toa &gt;= per))
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -0.92777    0.05840 -15.888  &lt; 2e-16 ***
## exposure      0.23839    0.17514   1.361 0.173452    
## var1         -0.04623    0.02704  -1.710 0.087334 .  
## factor(per)3  0.29313    0.07715   3.799 0.000145 ***
## factor(per)4  0.33902    0.09897   3.425 0.000614 ***
## factor(per)5  0.59851    0.12193   4.909 9.18e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2745.1  on 2317  degrees of freedom
## Residual deviance: 2663.5  on 2312  degrees of freedom
##   (1000 observations deleted due to missingness)
## AIC: 2675.5
## 
## Number of Fisher Scoring iterations: 4</code></pre></li>
</ul>
</div>
<div id="contemporaneous-exposure-models" class="section level4 hasAnchor" number="12.4.5.2">
<h4><span class="header-section-number">12.4.5.2</span> Contemporaneous exposure models<a href="statistical-inference.html#contemporaneous-exposure-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Similar to the lagged exposure models, we usually have the following</p>
<p><span class="math display">\[
y_t = f(W_t, y_t, X_t) + \varepsilon
\]</span></p>
<p>Furthermore, in the case of adoption, we have</p>
<p><span class="math display">\[
y_{it} = \left\{
\begin{array}{ll}
1 &amp; \mbox{if}\quad \rho\sum_{j\neq i}\frac{W_{ijt}y_{it}}{\sum_{j\neq i}W_{ijt}} + X_{it}\beta &gt; 0\\
0 &amp; \mbox{otherwise}
\end{array}
\right.
\]</span></p></li>
<li><p>Unfortunately, since <span class="math inline">\(y_t\)</span> is in both sides of the equation, this models cannot
be fitted using a standard probit or logit regression.</p></li>
<li><p>Two alternatives to solve this:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Using Instrumental Variables Probit (ivprobit in both R and Stata)</p></li>
<li><p>Use a Spatial Autoregressive (SAR) Probit (SpatialProbit and ProbitSpatial in R).</p></li>
</ol></li>
<li><p>We won’t cover these here.</p></li>
</ul>
</div>
</div>
<div id="problems-2" class="section level3 hasAnchor" number="12.4.6">
<h3><span class="header-section-number">12.4.6</span> Problems<a href="statistical-inference.html#problems-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using the dataset <a href="stats.rda">stats.rda</a>:</p>
<ol style="list-style-type: decimal">
<li><p>Compute Moran’s I as the function <code>summary.diffnet</code> does. For this you’ll need
to use the function <code>toa_mat</code> (which calculates the cumulative adoption matrix),
and <code>approx_geodesic</code> (which computes the geodesic matrix). (see <code>?summary.diffnet</code>
for more details).</p></li>
<li><p>Read the data as diffnet object, and fit the following logit model <span class="math inline">\(adopt = Exposure*\gamma + Measure*\beta + \varepsilon\)</span>.
What happens if you exclude the time-fixed effects?</p></li>
</ol>
<!-- (<a href="stats-solutions.r" target="_blank">solution script</a>) -->
<!-- ```{r datagen, echo=FALSE, cache=TRUE}
set.seed(1)
n <- 500
nper <- 5
X <- cbind(Measure=rnorm(n))
y <- cbind(sample(c(0, 1), n, TRUE, prob = c(.9, .1)))
# Baseline network
W <- (rgraph_ws(n, k=8, p = .2))
sim_space <- function(W, y, X, pers = 4, lag = FALSE, rho = .2, beta=.5) {
  W <- as.matrix(W)
  W <- W/(rowSums(W) + 1e-20)
  n <- nrow(W)
  for (i in 1:pers) {
    if (!lag)
      ynew <- (solve(diag(n) - rho*W) %*% (X*beta) + rnorm(n)) > 0
    else
      ynew <- (rho * (W %*% y[,i - as.integer(i != 1),drop=FALSE]) + beta*X + rnorm(n)) > 0
    
    y <- cbind(y, ifelse(
      y[,i - as.integer(i != 1),drop=FALSE] == 1,
      y[,i - as.integer(i != 1),drop=FALSE], 
      ynew)
      )
  }
  
  y
}
ans <- sim_space(W, y, X, pers = nper, lag=TRUE)
toa <- ncol(ans) - apply(ans, 1, sum)
X <- cbind(X, toa=ifelse(toa == 0, NA, toa))
save(X, W, file="stats.rda")
``` -->

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="simulation-of-diffusion-processes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stochastic-actor-oriented-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/gvegayon/appliedsnar/edit/master/part-01-09-netdiffuser.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/gvegayon/appliedsnar/blob/master/part-01-09-netdiffuser.Rmd",
"text": null
},
"download": ["appliedsnar.pdf", "appliedsnar.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
